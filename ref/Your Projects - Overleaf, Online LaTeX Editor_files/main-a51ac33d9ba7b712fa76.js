/*! For license information please see main-a51ac33d9ba7b712fa76.js.LICENSE.txt */
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.main=n():(e.Frontend=e.Frontend||{},e.Frontend.main=n())}(window,(function(){return function(e){function n(n){for(var r,i,c=n[0],s=n[1],l=n[2],d=0,f=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(u&&u(n);f.length;)f.shift()();return a.push.apply(a,l||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,c=1;c<t.length;c++){var s=t[c];0!==o[s]&&(r=!1)}r&&(a.splice(n--,1),e=i(i.s=t[0]))}return e}var r={},o={14:0},a=[];function i(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=r,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)i.d(t,r,function(n){return e[n]}.bind(null,r));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=n,c=c.slice();for(var l=0;l<c.length;l++)n(c[l]);var u=s;return a.push([908,0]),t()}({105:function(e,n){var t,r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];n.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},n.getSymbolTotalCodewords=function(e){return r[e]},n.getBCHDigit=function(e){for(var n=0;0!==e;)n++,e>>>=1;return n},n.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');t=e},n.isKanjiModeEnabled=function(){return void 0!==t},n.toSJIS=function(e){return t(e)}},106:function(e,n,t){var r=t(363),o=t(364);n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(e,n){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!r.isValid(n))throw new Error("Invalid version: "+n);return n>=1&&n<10?e.ccBits[0]:n<27?e.ccBits[1]:e.ccBits[2]},n.getBestModeForData=function(e){return o.testNumeric(e)?n.NUMERIC:o.testAlphanumeric(e)?n.ALPHANUMERIC:o.testKanji(e)?n.KANJI:n.BYTE},n.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},n.isValid=function(e){return e&&e.bit&&e.ccBits},n.from=function(e,t){if(n.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(e){return t}}},124:function(e,n,t){"use strict";var r=t(258);a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}();var o=a.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function a(e,n,t){return a.TYPED_ARRAY_SUPPORT||this instanceof a?"number"==typeof e?s(this,e):function(e,n,t,r){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer)return function(e,n,t,r){if(t<0||n.byteLength<t)throw new RangeError("'offset' is out of bounds");if(n.byteLength<t+(r||0))throw new RangeError("'length' is out of bounds");var o;o=void 0===t&&void 0===r?new Uint8Array(n):void 0===r?new Uint8Array(n,t):new Uint8Array(n,t,r);a.TYPED_ARRAY_SUPPORT?o.__proto__=a.prototype:o=l(e,o);return o}(e,n,t,r);if("string"==typeof n)return function(e,n){var t=0|d(n),r=c(e,t),o=r.write(n);o!==t&&(r=r.slice(0,o));return r}(e,n);return function(e,n){if(a.isBuffer(n)){var t=0|i(n.length),r=c(e,t);return 0===r.length||n.copy(r,0,0,t),r}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||(o=n.length)!=o?c(e,0):l(e,n);if("Buffer"===n.type&&Array.isArray(n.data))return l(e,n.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,n)}(this,e,n,t):new a(e,n,t)}function i(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function c(e,n){var t;return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n)).__proto__=a.prototype:(null===(t=e)&&(t=new a(n)),t.length=n),t}function s(e,n){var t=c(e,n<0?0:0|i(n));if(!a.TYPED_ARRAY_SUPPORT)for(var r=0;r<n;++r)t[r]=0;return t}function l(e,n){for(var t=n.length<0?0:0|i(n.length),r=c(e,t),o=0;o<t;o+=1)r[o]=255&n[o];return r}function u(e,n){var t;n=n||1/0;for(var r=e.length,o=null,a=[],i=0;i<r;++i){if((t=e.charCodeAt(i))>55295&&t<57344){if(!o){if(t>56319){(n-=3)>-1&&a.push(239,191,189);continue}if(i+1===r){(n-=3)>-1&&a.push(239,191,189);continue}o=t;continue}if(t<56320){(n-=3)>-1&&a.push(239,191,189),o=t;continue}t=65536+(o-55296<<10|t-56320)}else o&&(n-=3)>-1&&a.push(239,191,189);if(o=null,t<128){if((n-=1)<0)break;a.push(t)}else if(t<2048){if((n-=2)<0)break;a.push(t>>6|192,63&t|128)}else if(t<65536){if((n-=3)<0)break;a.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;a.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return a}function d(e){return a.isBuffer(e)?e.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)?e.byteLength:("string"!=typeof e&&(e=""+e),0===e.length?0:u(e).length)}a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),a.prototype.write=function(e,n,t){void 0===n||void 0===t&&"string"==typeof n?(t=this.length,n=0):isFinite(n)&&(n|=0,isFinite(t)?t|=0:t=void 0);var r=this.length-n;if((void 0===t||t>r)&&(t=r),e.length>0&&(t<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");return function(e,n,t,r){return function(e,n,t,r){for(var o=0;o<r&&!(o+t>=n.length||o>=e.length);++o)n[o+t]=e[o];return o}(u(n,e.length-t),e,t,r)}(this,e,n,t)},a.prototype.slice=function(e,n){var t,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(n=void 0===n?r:~~n)<0?(n+=r)<0&&(n=0):n>r&&(n=r),n<e&&(n=e),a.TYPED_ARRAY_SUPPORT)(t=this.subarray(e,n)).__proto__=a.prototype;else{var o=n-e;t=new a(o,void 0);for(var i=0;i<o;++i)t[i]=this[i+e]}return t},a.prototype.copy=function(e,n,t,r){if(t||(t=0),r||0===r||(r=this.length),n>=e.length&&(n=e.length),n||(n=0),r>0&&r<t&&(r=t),r===t)return 0;if(0===e.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-n<r-t&&(r=e.length-n+t);var o,i=r-t;if(this===e&&t<n&&n<r)for(o=i-1;o>=0;--o)e[o+n]=this[o+t];else if(i<1e3||!a.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+n]=this[o+t];else Uint8Array.prototype.set.call(e,this.subarray(t,t+i),n);return i},a.prototype.fill=function(e,n,t){if("string"==typeof e){if("string"==typeof n?(n=0,t=this.length):"string"==typeof t&&(t=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}}else"number"==typeof e&&(e&=255);if(n<0||this.length<n||this.length<t)throw new RangeError("Out of range index");if(t<=n)return this;var o;if(n>>>=0,t=void 0===t?this.length:t>>>0,e||(e=0),"number"==typeof e)for(o=n;o<t;++o)this[o]=e;else{var i=a.isBuffer(e)?e:new a(e),c=i.length;for(o=0;o<t-n;++o)this[o+n]=i[o%c]}return this},a.concat=function(e,n){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c(null,0);var t;if(void 0===n)for(n=0,t=0;t<e.length;++t)n+=e[t].length;var o=s(null,n),i=0;for(t=0;t<e.length;++t){var l=e[t];if(!a.isBuffer(l))throw new TypeError('"list" argument must be an Array of Buffers');l.copy(o,i),i+=l.length}return o},a.byteLength=d,a.prototype._isBuffer=!0,a.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.exports.alloc=function(e){var n=new a(e);return n.fill(0),n},e.exports.from=function(e){return new a(e)}},152:function(e,n,t){"use strict";function r(){try{var e;return(e=$).localStorage.apply(e,arguments)}catch(e){return console.error("localStorage exception",e),null}}angular.module("localStorage",[]).value("localStorage",r)},177:function(e,n,t){"use strict";t(13),t(12),t(11);function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return o(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}t(2).a.factory("queuedHttp",["$http","$q",function(e,n){var t=[],o=!1,a=function e(){if(!o){var n=t.shift();return null!=n?(o=!0,n().then((function(){return o=!1,e()})).catch((function(){return o=!1,e()}))):void 0}},i=function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];var c={},s=[],l=[];c.then=function(e,n){return s.push(e),null!=n&&l.push(n),c},c.catch=function(e){return l.push(e),c};var u=function(){return e.apply(void 0,r(Array.from(o||[]))).then((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Array.from(s).map((function(e){return e.apply(void 0,r(Array.from(n||[])))}))})).catch((function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Array.from(l).map((function(e){return e.apply(void 0,r(Array.from(n||[])))}))}))};return t.push(u),a(),c};return i.post=function(e,n){return i({method:"POST",url:e,data:n})},i}])},178:function(e,n,t){"use strict";t(7),t(62);var r=t(2),o=t(160),a=t.n(o);r.a.factory("algoliaSearch",(function(){var e,n;if(null!=(null!=window.sharelatex?window.sharelatex.algolia:void 0)&&null!=i(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.wiki}))){var t=a()(null!=window.sharelatex.algolia?window.sharelatex.algolia.app_id:void 0,null!=window.sharelatex.algolia?window.sharelatex.algolia.api_key:void 0);n=t.initIndex(i(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.wiki}))),e=t.initIndex(i(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.kb})))}return{searchWiki:n?n.search.bind(n):null,searchKB:e?e.search.bind(e):null}}));function i(e,n){return null!=e?n(e):void 0}},2:function(e,n,t){"use strict";t(7),t(27),t(62),t(100),t(317),t(318),t(3),t(319),t(320),t(321),t(322),t(323),t(173),t(324),t(325),t(326),t(327);var r=t(22);t.p=window.baseAssetPath;var o=t(71),a=(t(239),t(28),angular.module("ErrorCatcher",[]));a.config(["$provide",function(e){return e.decorator("$exceptionHandler",["$log","$delegate",function(e,n){return function(e,t){if("Possibly unhandled rejection: canceled"!==e||void 0!==t)return Object(o.a)(e,(function(e){return e.setTag("handler","angular-exception-handler"),e})),n(e,t)}}])}]),a.factory("unAuthHttpResponseInterceptor",["$q","$location",function(e,n){return{responseError:function responseError(n){return[401,403].includes(n.status)&&!(null!=n.config?n.config.disableAutoLoginRedirect:void 0)&&(window.location.pathname.match(/^\/project/)?window.location="/login?redir=".concat(encodeURI(window.location.pathname)):window.location="/login"),e.reject(n)}}}]),a.config(["$httpProvider",function(e){return e.interceptors.push("unAuthHttpResponseInterceptor")}]);t(152),t(240);var i=angular.module("SharelatexApp",["ui.bootstrap","autocomplete","RecursionHelper","ng-context-menu","ngSanitize","ipCookie","ErrorCatcher","localStorage","sessionStorage","ngTagsInput","ui.select"]).config(["$qProvider","$httpProvider","uiSelectConfig",function(e,n,t){return e.errorOnUnhandledRejections(!1),t.spinnerClass="fa fa-refresh ui-select-spin",r="undefined"!=typeof MathJax&&null!==MathJax?MathJax.Hub:void 0,o=function(e){return e.Config({messageStyle:"none",imageFont:null,"fast-preview":{disabled:!0},"HTML-CSS":{availableFonts:["TeX"],scale:110,matchFontHeight:!1},TeX:{equationNumbers:{autoNumber:"AMS"},useLabelIDs:!1},skipStartupTypeset:!0,tex2jax:{processEscapes:!0,inlineMath:[["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]}})},null!=r?o(r):void 0;var r,o}]);i.run(["$rootScope","$templateCache",function(e,n){e.usersEmail=Object(r.a)("ol-usersEmail"),n.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="fa fa-times" aria-hidden="true"></i></a></span></div>')}]);var c=window.location.search.match(/debug=true/);window.sl_debugging=c,window.sl_console=c?console:{log:function(){}};n.a=i},22:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));t(45),t(13),t(19),t(12),t(24),t(6),t(232),t(9),t(11),t(46),t(21);var r=t(3),o=t.n(r),a=new Map;function i(e,n){if(a.has(e))return a.get(e);var t=document.head.querySelector('meta[name="'.concat(e,'"]'));if(!t)return n;var r,o=t.content;switch(t.dataset.type){case"boolean":r=t.hasAttribute("content");break;case"json":r=o?JSON.parse(o):void 0;break;default:r=o}return a.set(e,r),r}window.data=window.data||{},Array.from(document.querySelectorAll('meta[name^="ol-"]')).map((function(e){return e.name})).sort().forEach((function(e){var n=e.slice("ol-".length);o.a.set(window,n,i(e)),o.a.set(window.data,n,i(e))}))},239:function(e,n){angular.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(e){return{compile:function(n,t){angular.isFunction(t)&&(t={post:t});var r,o=n.contents().remove();return{pre:t&&t.pre?t.pre:null,post:function(n,a){r||(r=e(o)),r(n,(function(e){a.append(e)})),t&&t.post&&t.post.apply(null,arguments)}}}}}])},240:function(e,n){angular.module("sessionStorage",[]).value("sessionStorage",(function(){try{var e;return(e=$).sessionStorage.apply(e,arguments)}catch(e){return console.error("sessionStorage exception",e),null}}))},243:function(e,n,t){"use strict";var r=t(2),o=t(59);r.a.controller("FreeTrialModalController",["$scope","eventTracking",function(e,n){e.buttonClass="btn-primary",e.startFreeTrial=function(t,r){return Object(o.a)(t,r,e,n)}}]),r.a.controller("UpgradeModalController",["$scope","eventTracking",function(e,n){e.buttonClass="btn-primary",e.upgradePlan=function(n){return Object(o.b)(n,e)}}])},244:function(e,n,t){"use strict";var r=t(16),o=t.n(r),a=t(2),i=(t(152),0),c=new Date;a.a.factory("eventTracking",["$http","localStorage",function(e,n){var t=function(){var e=n("mbEvents");return null==e&&n("mbEvents",e={}),e},r=function(e){return t()[e]||!1},a=function(e){var r=t();return r[e]=!0,n("mbEvents",r)};return{send:function(e,n,t,r){return ga("send","event",e,n,t,r)},sendGAOnce:function(e,n,t,o){if(!r(n))return a(n),this.send(e,n,t,o)},editingSessionHeartbeat:function(){if(c<=new Date){e({url:"/editingSession/".concat(window.project_id),method:"PUT",headers:{"X-CSRF-Token":window.csrfToken}});var n=++i<=2?30:i<=6?60*(i-2):300;return c=o()().add(n,"seconds").toDate()}},sendMB:function(n,t){return null==t&&(t={}),e({url:"/event/".concat(n),method:"POST",data:t,headers:{"X-CSRF-Token":window.csrfToken}})},sendMBSampled:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;if(Math.random()<t)return this.sendMB(e,n)},sendMBOnce:function(e,n){if(!r(e))return a(e),this.sendMB(e,n)},eventInCache:function(e){return r(e)}}}]);$(".navbar a").on("click",(function(e){var n=$(e.target).attr("href");if(null!=n)return ga("send","event","navigation","top menu bar",n)}))},245:function(e,n,t){"use strict";t(28),t(54);var r=t(2);r.a.controller("SystemMessagesController",["$http","$scope",function(e,n){n.messages=[];var t=function(){!document.hidden&&navigator.onLine&&e.get("/system/messages").then((function(e){e.headers("content-type").includes("json")&&(n.messages=e.data)})).catch((function(){}))};t(),setInterval(t,9e5)}]);r.a.controller("SystemMessageController",["$scope","$sce",function(e,n){return e.hidden=$.localStorage("systemMessage.hide.".concat(e.message._id)),e.protected="protected"===e.message._id,e.htmlContent=e.message.content,e.hide=function(){if(!e.protected)return e.hidden=!0,$.localStorage("systemMessage.hide.".concat(e.message._id),!0)}}])},248:function(e,n,t){"use strict";t(2).a.constant("ExposedSettings",window.ExposedSettings)},250:function(e,n,t){"use strict";var r=t(2);r.a.directive("stopPropagation",["$http",function(e){return{restrict:"A",link:function(e,n,t){return n.bind(t.stopPropagation,(function(e){return e.stopPropagation()}))}}}]);r.a.directive("preventDefault",["$http",function(e){return{restrict:"A",link:function(e,n,t){return n.bind(t.preventDefault,(function(e){return e.preventDefault()}))}}}])},251:function(e,n,t){"use strict";t(140);var r=t(2);function o(e){e.focus();var n=e.val();if(null!=e[0].setSelectionRange){var t=n.lastIndexOf(".");return-1===t&&(t=n.length),e[0].setSelectionRange(0,t)}}r.a.directive("focusWhen",["$timeout",function(e){return{restrict:"A",link:function(n,t,r){return n.$watch(r.focusWhen,(function(n){if(n)return e((function(){return t.focus()}))}))}}}]),r.a.directive("focusOn",["$timeout",function(e){return{restrict:"A",link:function(e,n,t){return e.$on(t.focusOn,(function(){return n.focus()}))}}}]),r.a.directive("selectWhen",["$timeout",function(e){return{restrict:"A",link:function(n,t,r){return n.$watch(r.selectWhen,(function(n){if(n)return e((function(){return t.select()}))}))}}}]),r.a.directive("selectOn",["$timeout",function(e){return{restrict:"A",link:function(e,n,t){return e.$on(t.selectOn,(function(){return n.select()}))}}}]),r.a.directive("selectNameWhen",["$timeout",function(e){return{restrict:"A",link:function(n,t,r){return n.$watch(r.selectNameWhen,(function(n){if(n)return e((function(){return o(t)}))}))}}}]),r.a.directive("selectNameOn",(function(){return{restrict:"A",link:function(e,n,t){return e.$on(t.selectNameOn,(function(){return o(n)}))}}})),r.a.directive("focus",["$timeout",function(e){return{scope:{trigger:"@focus"},link:function(n,t){return n.$watch("trigger",(function(n){if("true"===n)return e((function(){return t[0].focus()}))}))}}}])},252:function(e,n,t){"use strict";var r=t(2),o=t(209),a=t.n(o);r.a.directive("fineUpload",["$timeout",function(e){return{scope:{multiple:"=",endpoint:"@",templateId:"@",sizeLimit:"@",allowedExtensions:"=",onCompleteCallback:"=",onUploadCallback:"=",onValidateBatch:"=",onErrorCallback:"=",onSubmitCallback:"=",onCancelCallback:"=",autoUpload:"=",params:"=",control:"="},link:function(e,n,t){var r,o,i=e.multiple||!1,c=e.endpoint,s=e.templateId;o=null!=e.allowedExtensions?{allowedExtensions:e.allowedExtensions}:{},e.sizeLimit&&(o.sizeLimit=e.sizeLimit);var l=e.maxConnections||1,u=e.onCompleteCallback||function(){},d=e.onUploadCallback||function(){},f=e.onErrorCallback||function(){},m=e.onValidateBatch||function(){},p=e.onSubmitCallback||function(){},h=e.onCancelCallback||function(){};r=null==e.autoUpload||e.autoUpload;var g=e.params||{};g._csrf=window.csrfToken;var v=new a.a.FineUploader({element:n[0],multiple:i,autoUpload:r,disabledCancelForFormUploads:!0,validation:o,maxConnections:l,request:{endpoint:c,forceMultipart:!0,params:g,paramsInBody:!1},callbacks:{onComplete:u,onUpload:d,onValidateBatch:m,onError:f,onSubmit:p,onCancel:h},template:s,failedUploadTextDisplay:{mode:"custom",responseProperty:"error"}});return window.q=v,null!=e.control&&(e.control.q=v),v}}}])},253:function(e,n,t){"use strict";t(2).a.directive("onEnter",(function(){return function(e,n,t){return n.bind("keydown keypress",(function(n){if(13===n.which)return e.$apply((function(){return e.$eval(t.onEnter,{event:n})})),n.preventDefault()}))}}))},254:function(e,n,t){"use strict";function r(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return o(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==t.return||t.return()}finally{if(s)throw i}}}}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}t(2).a.factory("validateCaptcha",(function(){var e=[],n=function(n){var t,o=r(e);try{for(o.s();!(t=o.n()).done;){(0,t.value)(n)}}catch(e){o.e(e)}finally{o.f()}e=[]},t=null;return function(r,o){if(null==r&&(r=function(e){}),"undefined"==typeof grecaptcha||null===grecaptcha||o)return r();if(e.push(r),e.push((function(){return grecaptcha.reset()})),null==t){var a=$("#recaptcha")[0];t=grecaptcha.render(a,{callback:n})}return grecaptcha.execute(t)}}))},255:function(e,n,t){"use strict";t(2).a.factory("validateCaptchaV3",(function(){var e=window.grecaptcha,n=window.ExposedSettings;return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e&&n&&n.recaptchaSiteKeyV3&&e.ready((function(){e.execute(n.recaptchaSiteKeyV3,{action:t}).then(r)}))}}))},256:function(e,n,t){"use strict";t(20);var r=t(2),o=t(16),a=t.n(o);a.a.updateLocale("en",{calendar:{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",lastWeek:"ddd, Do MMM YY",nextWeek:"ddd, Do MMM YY",sameElse:"ddd, Do MMM YY"}}),r.a.filter("formatDate",(function(){return function(e,n){return e?(null==n&&(n="Do MMM YYYY, h:mm a"),a()(e).format(n)):"N/A"}})),r.a.filter("utcDate",(function(){return function(e,n){return e?(null==n&&(n="D MMM YYYY, HH:mm:ss"),a()(e).utc().format(n)+" UTC"):"N/A"}})),r.a.filter("relativeDate",(function(){return function(e){return a()(e).calendar()}})),r.a.filter("fromNowDate",(function(){return function(e){return a()(e).fromNow()}}))},257:function(e,n,t){"use strict";t.r(n);t(8),t(13),t(9),t(7),t(31),t(11),t(34);var r=t(2);t(178);r.a.controller("ContactModal",["$scope","$modal","sessionStorage",function(e,n,t){t("contact-form.user-input",null),e.contactUsModal=function(){n.open({templateUrl:"contactModalTemplate",controller:"ContactModalController",scope:e})}}]),r.a.controller("ContactGeneralModal",["$scope","$modal","sessionStorage",function(e,n,t){t("contact-form.user-input",null),e.openModal=function(){n.open({templateUrl:"contactGeneralModalTemplate",controller:"ContactGeneralModalController"})}}]),r.a.controller("ContactModalController",["$scope","$modalInstance",function(e,n){return e.close=function(){return n.close()}}]),r.a.controller("ContactGeneralModalController",["$scope","$modalInstance",function(e,n){return e.close=function(){return n.close()}}]),n.default=r.a.controller("ContactFormController",["$scope","algoliaSearch","eventTracking","$http","sessionStorage",function(e,n,t,r,o){var a=o("contact-form.user-input");a?e.form=a:(e.form={email:""},window.project_id&&(e.form.project_url=window.location.href)),e.sent=!1,e.sending=!1,e.suggestions=[],e.$on("modal.closing",(function(){e.sent?o("contact-form.user-input",null):o("contact-form.user-input",{subject:e.form.subject,message:e.form.message,project_url:e.form.project_url})}));var i=function(n,r){var o=function(){for(var e,n,t=[],o=0,a=Array.from(r.hits);o<a.length;o++){var i=a[o],c=(e=null!=i?i.pageName:void 0,n=function(e){return e.replace(/\s/g,"_")},null!=e?n(e):void 0),s=encodeURIComponent(c),l=i.kb?"how-to":"latex",u=i.sectionName&&""!==i.sectionName,d=u?"#".concat(i.sectionName.replace(/\s/g,"_")):"",f=i._highlightResult.pageName.value;u&&(f+=" - "+i.sectionName),t.push({url:"/learn/".concat(l,"/").concat(s).concat(d),name:f})}return t}();return r.hits.length&&t.sendMB("contact-form-suggestions-shown"),e.$applyAsync((function(){return e.suggestions=o}))};e.contactUs=function(){if(null!=e.form.email&&""!==e.form.email){e.sending=!0;var n=Math.floor(65536*(1+Math.random())).toString(32),t=e.form.message;null!=e.form.project_url&&(t="".concat(t,"\n\n project_url = ").concat(e.form.project_url));var o={_csrf:window.csrfToken,email:e.form.email,message:t||"",subject:e.form.subject+" - [".concat(n,"]"),labels:"support",inbox:e.inbox||"support"},a=r.post("/support",o);return a.then((function(n){return e.sent=!0})),a.catch((function(){return e.error=!0,e.sending=!1,console.log("the request failed")}))}console.log("email not set")},e.$watch("inbox",(function(n){return e.inbox}))();var c=e.$watch("showContactFormSuggestions",(function(e){if(null!=e)return!0===e&&s(),c()})),s=function(){return e.$watch("form.subject",(function(t,r){if(!(t&&t!==r&&t.length>3))return e.suggestions=[];n.searchWiki(t,{hitsPerPage:3,typoTolerance:"strict"},i)}))};return e.clickSuggestionLink=function(e){return t.sendMB("contact-form-suggestions-clicked",{url:e})}}])},258:function(e,n){var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},259:function(e,n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2},n.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},n.from=function(e,t){if(n.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(e){return t}}},33:function(e,n,t){"use strict";t(18),t(13),t(24),t(9),t(7),t(31),t(11),t(27);var r=t(98),o=t.n(r);function a(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return t}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}n.a={getColorScheme:function(e,n){return this.isDarkTheme(n)?{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 100%, 28%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 100%, 20%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 100%, 60%);")}:{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 70%, 85%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 70%, 95%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 70%, 40%);")}},isDarkTheme:function(e){var n=e.find(".ace_editor").css("background-color"),t=a(Array.from(n.match(/rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)/)),4),r=(t[0],t[1]),o=t[2],i=t[3];return(r=parseInt(r,10))+(o=parseInt(o,10))+(i=parseInt(i,10))<384},ANONYMOUS_HUE:100,OWN_HUE:200,OWN_HUE_BLOCKED_SIZE:20,TOTAL_HUES:360,getHueForUserId:function(e){if(null==e||"anonymous-user"===e)return this.ANONYMOUS_HUE;if(window.user.id===e)return this.OWN_HUE;var n=this.getHueForId(e);return n>this.OWN_HUE-this.OWN_HUE_BLOCKED_SIZE&&n<this.OWN_HUE+this.OWN_HUE_BLOCKED_SIZE&&(n=(n-=this.OWN_HUE)+this.TOTAL_HUES-this.OWN_HUE_BLOCKED_SIZE),n},getHueForTagId:function(e){return this.getHueForId(e)},getHueForId:function(e){var n=o()(e);return parseInt(n.toString().slice(0,8),16)%(this.TOTAL_HUES-2*this.OWN_HUE_BLOCKED_SIZE)}}},362:function(e,n,t){var r=t(259),o=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];n.getBlocksCount=function(e,n){switch(n){case r.L:return o[4*(e-1)+0];case r.M:return o[4*(e-1)+1];case r.Q:return o[4*(e-1)+2];case r.H:return o[4*(e-1)+3];default:return}},n.getTotalCodewordsCount=function(e,n){switch(n){case r.L:return a[4*(e-1)+0];case r.M:return a[4*(e-1)+1];case r.Q:return a[4*(e-1)+2];case r.H:return a[4*(e-1)+3];default:return}}},363:function(e,n){n.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},364:function(e,n){var t="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",r="(?:(?![A-Z0-9 $%*+\\-./:]|"+(t=t.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";n.KANJI=new RegExp(t,"g"),n.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),n.BYTE=new RegExp(r,"g"),n.NUMERIC=new RegExp("[0-9]+","g"),n.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");var o=new RegExp("^"+t+"$"),a=new RegExp("^[0-9]+$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");n.testKanji=function(e){return o.test(e)},n.testNumeric=function(e){return a.test(e)},n.testAlphanumeric=function(e){return i.test(e)}},365:function(e,n){function t(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");var n=e.slice().replace("#","").split("");if(n.length<3||5===n.length||n.length>8)throw new Error("Invalid hex color: "+e);3!==n.length&&4!==n.length||(n=Array.prototype.concat.apply([],n.map((function(e){return[e,e]})))),6===n.length&&n.push("F","F");var t=parseInt(n.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:255&t,hex:"#"+n.slice(0,6).join("")}}n.getOptions=function(e){e||(e={}),e.color||(e.color={});var n=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,o=e.scale||4;return{width:r,scale:r?4:o,margin:n,color:{dark:t(e.color.dark||"#000000ff"),light:t(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},n.getScale=function(e,n){return n.width&&n.width>=e+2*n.margin?n.width/(e+2*n.margin):n.scale},n.getImageWidth=function(e,t){var r=n.getScale(e,t);return Math.floor((e+2*t.margin)*r)},n.qrToImageData=function(e,t,r){for(var o=t.modules.size,a=t.modules.data,i=n.getScale(o,r),c=Math.floor((o+2*r.margin)*i),s=r.margin*i,l=[r.color.light,r.color.dark],u=0;u<c;u++)for(var d=0;d<c;d++){var f=4*(u*c+d),m=r.color.light;if(u>=s&&d>=s&&u<c-s&&d<c-s)m=l[a[Math.floor((u-s)/i)*o+Math.floor((d-s)/i)]?1:0];e[f++]=m.r,e[f++]=m.g,e[f++]=m.b,e[f]=m.a}}},471:function(e,n,t){var r=t(536),o=t(537),a=t(557),i=t(558);function c(e,n,t,a,i){var c=[].slice.call(arguments,1),s=c.length,l="function"==typeof c[s-1];if(!l&&!r())throw new Error("Callback required as last argument");if(!l){if(s<1)throw new Error("Too few arguments provided");return 1===s?(t=n,n=a=void 0):2!==s||n.getContext||(a=t,t=n,n=void 0),new Promise((function(r,i){try{var c=o.create(t,a);r(e(c,n,a))}catch(e){i(e)}}))}if(s<2)throw new Error("Too few arguments provided");2===s?(i=t,t=n,n=a=void 0):3===s&&(n.getContext&&void 0===i?(i=a,a=void 0):(i=a,a=t,t=n,n=void 0));try{var u=o.create(t,a);i(null,e(u,n,a))}catch(e){i(e)}}n.create=o.create,n.toCanvas=c.bind(null,a.render),n.toDataURL=c.bind(null,a.renderToDataURL),n.toString=c.bind(null,(function(e,n,t){return i.render(e,t)}))},535:function(e,n,t){t(257)},536:function(e,n){e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},537:function(e,n,t){var r=t(124),o=t(105),a=t(259),i=t(538),c=t(539),s=t(540),l=t(541),u=t(542),d=t(362),f=t(543),m=t(549),p=t(550),h=t(106),g=t(551),v=t(258);function w(e,n,t){var r,o,a=e.size,i=p.getEncodedBits(n,t);for(r=0;r<15;r++)o=1==(i>>r&1),r<6?e.set(r,8,o,!0):r<8?e.set(r+1,8,o,!0):e.set(a-15+r,8,o,!0),r<8?e.set(8,a-r-1,o,!0):r<9?e.set(8,15-r-1+1,o,!0):e.set(8,15-r-1,o,!0);e.set(a-8,8,1,!0)}function y(e,n,t){var a=new i;t.forEach((function(n){a.put(n.mode.bit,4),a.put(n.getLength(),h.getCharCountIndicator(n.mode,e)),n.write(a)}));var c=8*(o.getSymbolTotalCodewords(e)-d.getTotalCodewordsCount(e,n));for(a.getLengthInBits()+4<=c&&a.put(0,4);a.getLengthInBits()%8!=0;)a.putBit(0);for(var s=(c-a.getLengthInBits())/8,l=0;l<s;l++)a.put(l%2?17:236,8);return function(e,n,t){for(var a=o.getSymbolTotalCodewords(n),i=d.getTotalCodewordsCount(n,t),c=a-i,s=d.getBlocksCount(n,t),l=s-a%s,u=Math.floor(a/s),m=Math.floor(c/s),p=m+1,h=u-m,g=new f(h),v=0,w=new Array(s),y=new Array(s),b=0,S=r.from(e.buffer),C=0;C<s;C++){var T=C<l?m:p;w[C]=S.slice(v,v+T),y[C]=g.encode(w[C]),v+=T,b=Math.max(b,T)}var P,E,M=r.alloc(a),j=0;for(P=0;P<b;P++)for(E=0;E<s;E++)P<w[E].length&&(M[j++]=w[E][P]);for(P=0;P<h;P++)for(E=0;E<s;E++)M[j++]=y[E][P];return M}(a,e,n)}function b(e,n,t,r){var a;if(v(e))a=g.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");var i=n;if(!i){var d=g.rawSplit(e);i=m.getBestVersionForData(d,t)}a=g.fromString(e,i||40)}var f=m.getBestVersionForData(a,t);if(!f)throw new Error("The amount of data is too big to be stored in a QR Code");if(n){if(n<f)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+f+".\n")}else n=f;var p=y(n,t,a),h=o.getSymbolSize(n),b=new c(h);return function(e,n){for(var t=e.size,r=l.getPositions(n),o=0;o<r.length;o++)for(var a=r[o][0],i=r[o][1],c=-1;c<=7;c++)if(!(a+c<=-1||t<=a+c))for(var s=-1;s<=7;s++)i+s<=-1||t<=i+s||(c>=0&&c<=6&&(0===s||6===s)||s>=0&&s<=6&&(0===c||6===c)||c>=2&&c<=4&&s>=2&&s<=4?e.set(a+c,i+s,!0,!0):e.set(a+c,i+s,!1,!0))}(b,n),function(e){for(var n=e.size,t=8;t<n-8;t++){var r=t%2==0;e.set(t,6,r,!0),e.set(6,t,r,!0)}}(b),function(e,n){for(var t=s.getPositions(n),r=0;r<t.length;r++)for(var o=t[r][0],a=t[r][1],i=-2;i<=2;i++)for(var c=-2;c<=2;c++)-2===i||2===i||-2===c||2===c||0===i&&0===c?e.set(o+i,a+c,!0,!0):e.set(o+i,a+c,!1,!0)}(b,n),w(b,t,0),n>=7&&function(e,n){for(var t,r,o,a=e.size,i=m.getEncodedBits(n),c=0;c<18;c++)t=Math.floor(c/3),r=c%3+a-8-3,o=1==(i>>c&1),e.set(t,r,o,!0),e.set(r,t,o,!0)}(b,n),function(e,n){for(var t=e.size,r=-1,o=t-1,a=7,i=0,c=t-1;c>0;c-=2)for(6===c&&c--;;){for(var s=0;s<2;s++)if(!e.isReserved(o,c-s)){var l=!1;i<n.length&&(l=1==(n[i]>>>a&1)),e.set(o,c-s,l),-1===--a&&(i++,a=7)}if((o+=r)<0||t<=o){o-=r,r=-r;break}}}(b,p),isNaN(r)&&(r=u.getBestMask(b,w.bind(null,b,t))),u.applyMask(r,b),w(b,t,r),{modules:b,version:n,errorCorrectionLevel:t,maskPattern:r,segments:a}}n.create=function(e,n){if(void 0===e||""===e)throw new Error("No input text");var t,r,i=a.M;return void 0!==n&&(i=a.from(n.errorCorrectionLevel,a.M),t=m.from(n.version),r=u.from(n.maskPattern),n.toSJISFunc&&o.setToSJISFunction(n.toSJISFunc)),b(e,t,i,r)}},538:function(e,n){function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){var n=Math.floor(e/8);return 1==(this.buffer[n]>>>7-e%8&1)},put:function(e,n){for(var t=0;t<n;t++)this.putBit(1==(e>>>n-t-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),e&&(this.buffer[n]|=128>>>this.length%8),this.length++}},e.exports=t},539:function(e,n,t){var r=t(124);function o(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=r.alloc(e*e),this.reservedBit=r.alloc(e*e)}o.prototype.set=function(e,n,t,r){var o=e*this.size+n;this.data[o]=t,r&&(this.reservedBit[o]=!0)},o.prototype.get=function(e,n){return this.data[e*this.size+n]},o.prototype.xor=function(e,n,t){this.data[e*this.size+n]^=t},o.prototype.isReserved=function(e,n){return this.reservedBit[e*this.size+n]},e.exports=o},540:function(e,n,t){var r=t(105).getSymbolSize;n.getRowColCoords=function(e){if(1===e)return[];for(var n=Math.floor(e/7)+2,t=r(e),o=145===t?26:2*Math.ceil((t-13)/(2*n-2)),a=[t-7],i=1;i<n-1;i++)a[i]=a[i-1]-o;return a.push(6),a.reverse()},n.getPositions=function(e){for(var t=[],r=n.getRowColCoords(e),o=r.length,a=0;a<o;a++)for(var i=0;i<o;i++)0===a&&0===i||0===a&&i===o-1||a===o-1&&0===i||t.push([r[a],r[i]]);return t}},541:function(e,n,t){var r=t(105).getSymbolSize;n.getPositions=function(e){var n=r(e);return[[0,0],[n-7,0],[0,n-7]]}},542:function(e,n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var t=3,r=3,o=40,a=10;function i(e,t,r){switch(e){case n.Patterns.PATTERN000:return(t+r)%2==0;case n.Patterns.PATTERN001:return t%2==0;case n.Patterns.PATTERN010:return r%3==0;case n.Patterns.PATTERN011:return(t+r)%3==0;case n.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case n.Patterns.PATTERN101:return t*r%2+t*r%3==0;case n.Patterns.PATTERN110:return(t*r%2+t*r%3)%2==0;case n.Patterns.PATTERN111:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}}n.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},n.from=function(e){return n.isValid(e)?parseInt(e,10):void 0},n.getPenaltyN1=function(e){for(var n=e.size,r=0,o=0,a=0,i=null,c=null,s=0;s<n;s++){o=a=0,i=c=null;for(var l=0;l<n;l++){var u=e.get(s,l);u===i?o++:(o>=5&&(r+=t+(o-5)),i=u,o=1),(u=e.get(l,s))===c?a++:(a>=5&&(r+=t+(a-5)),c=u,a=1)}o>=5&&(r+=t+(o-5)),a>=5&&(r+=t+(a-5))}return r},n.getPenaltyN2=function(e){for(var n=e.size,t=0,o=0;o<n-1;o++)for(var a=0;a<n-1;a++){var i=e.get(o,a)+e.get(o,a+1)+e.get(o+1,a)+e.get(o+1,a+1);4!==i&&0!==i||t++}return t*r},n.getPenaltyN3=function(e){for(var n=e.size,t=0,r=0,a=0,i=0;i<n;i++){r=a=0;for(var c=0;c<n;c++)r=r<<1&2047|e.get(i,c),c>=10&&(1488===r||93===r)&&t++,a=a<<1&2047|e.get(c,i),c>=10&&(1488===a||93===a)&&t++}return t*o},n.getPenaltyN4=function(e){for(var n=0,t=e.data.length,r=0;r<t;r++)n+=e.data[r];return Math.abs(Math.ceil(100*n/t/5)-10)*a},n.applyMask=function(e,n){for(var t=n.size,r=0;r<t;r++)for(var o=0;o<t;o++)n.isReserved(o,r)||n.xor(o,r,i(e,o,r))},n.getBestMask=function(e,t){for(var r=Object.keys(n.Patterns).length,o=0,a=1/0,i=0;i<r;i++){t(i),n.applyMask(i,e);var c=n.getPenaltyN1(e)+n.getPenaltyN2(e)+n.getPenaltyN3(e)+n.getPenaltyN4(e);n.applyMask(i,e),c<a&&(a=c,o=i)}return o}},543:function(e,n,t){var r=t(124),o=t(544),a=t(260).Buffer;function i(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}i.prototype.initialize=function(e){this.degree=e,this.genPoly=o.generateECPolynomial(this.degree)},i.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");var n=r.alloc(this.degree),t=a.concat([e,n],e.length+this.degree),i=o.mod(t,this.genPoly),c=this.degree-i.length;if(c>0){var s=r.alloc(this.degree);return i.copy(s,c),s}return i},e.exports=i},544:function(e,n,t){var r=t(124),o=t(545);n.mul=function(e,n){for(var t=r.alloc(e.length+n.length-1),a=0;a<e.length;a++)for(var i=0;i<n.length;i++)t[a+i]^=o.mul(e[a],n[i]);return t},n.mod=function(e,n){for(var t=r.from(e);t.length-n.length>=0;){for(var a=t[0],i=0;i<n.length;i++)t[i]^=o.mul(n[i],a);for(var c=0;c<t.length&&0===t[c];)c++;t=t.slice(c)}return t},n.generateECPolynomial=function(e){for(var t=r.from([1]),a=0;a<e;a++)t=n.mul(t,[1,o.exp(a)]);return t}},545:function(e,n,t){var r=t(124),o=r.alloc(512),a=r.alloc(256);!function(){for(var e=1,n=0;n<255;n++)o[n]=e,a[e]=n,256&(e<<=1)&&(e^=285);for(n=255;n<512;n++)o[n]=o[n-255]}(),n.log=function(e){if(e<1)throw new Error("log("+e+")");return a[e]},n.exp=function(e){return o[e]},n.mul=function(e,n){return 0===e||0===n?0:o[a[e]+a[n]]}},549:function(e,n,t){var r=t(105),o=t(362),a=t(259),i=t(106),c=t(363),s=t(258),l=r.getBCHDigit(7973);function u(e,n){return i.getCharCountIndicator(e,n)+4}function d(e,n){var t=0;return e.forEach((function(e){var r=u(e.mode,n);t+=r+e.getBitsLength()})),t}n.from=function(e,n){return c.isValid(e)?parseInt(e,10):n},n.getCapacity=function(e,n,t){if(!c.isValid(e))throw new Error("Invalid QR Code version");void 0===t&&(t=i.BYTE);var a=8*(r.getSymbolTotalCodewords(e)-o.getTotalCodewordsCount(e,n));if(t===i.MIXED)return a;var s=a-u(t,e);switch(t){case i.NUMERIC:return Math.floor(s/10*3);case i.ALPHANUMERIC:return Math.floor(s/11*2);case i.KANJI:return Math.floor(s/13);case i.BYTE:default:return Math.floor(s/8)}},n.getBestVersionForData=function(e,t){var r,o=a.from(t,a.M);if(s(e)){if(e.length>1)return function(e,t){for(var r=1;r<=40;r++){if(d(e,r)<=n.getCapacity(r,t,i.MIXED))return r}}(e,o);if(0===e.length)return 1;r=e[0]}else r=e;return function(e,t,r){for(var o=1;o<=40;o++)if(t<=n.getCapacity(o,r,e))return o}(r.mode,r.getLength(),o)},n.getEncodedBits=function(e){if(!c.isValid(e)||e<7)throw new Error("Invalid QR Code version");for(var n=e<<12;r.getBCHDigit(n)-l>=0;)n^=7973<<r.getBCHDigit(n)-l;return e<<12|n}},550:function(e,n,t){var r=t(105),o=r.getBCHDigit(1335);n.getEncodedBits=function(e,n){for(var t=e.bit<<3|n,a=t<<10;r.getBCHDigit(a)-o>=0;)a^=1335<<r.getBCHDigit(a)-o;return 21522^(t<<10|a)}},551:function(e,n,t){var r=t(106),o=t(552),a=t(553),i=t(554),c=t(555),s=t(364),l=t(105),u=t(556);function d(e){return unescape(encodeURIComponent(e)).length}function f(e,n,t){for(var r,o=[];null!==(r=e.exec(t));)o.push({data:r[0],index:r.index,mode:n,length:r[0].length});return o}function m(e){var n,t,o=f(s.NUMERIC,r.NUMERIC,e),a=f(s.ALPHANUMERIC,r.ALPHANUMERIC,e);return l.isKanjiModeEnabled()?(n=f(s.BYTE,r.BYTE,e),t=f(s.KANJI,r.KANJI,e)):(n=f(s.BYTE_KANJI,r.BYTE,e),t=[]),o.concat(a,n,t).sort((function(e,n){return e.index-n.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function p(e,n){switch(n){case r.NUMERIC:return o.getBitsLength(e);case r.ALPHANUMERIC:return a.getBitsLength(e);case r.KANJI:return c.getBitsLength(e);case r.BYTE:return i.getBitsLength(e)}}function h(e,n){var t,s=r.getBestModeForData(e);if((t=r.from(n,s))!==r.BYTE&&t.bit<s.bit)throw new Error('"'+e+'" cannot be encoded with mode '+r.toString(t)+".\n Suggested mode is: "+r.toString(s));switch(t!==r.KANJI||l.isKanjiModeEnabled()||(t=r.BYTE),t){case r.NUMERIC:return new o(e);case r.ALPHANUMERIC:return new a(e);case r.KANJI:return new c(e);case r.BYTE:return new i(e)}}n.fromArray=function(e){return e.reduce((function(e,n){return"string"==typeof n?e.push(h(n,null)):n.data&&e.push(h(n.data,n.mode)),e}),[])},n.fromString=function(e,t){for(var o=function(e,n){for(var t={},o={start:{}},a=["start"],i=0;i<e.length;i++){for(var c=e[i],s=[],l=0;l<c.length;l++){var u=c[l],d=""+i+l;s.push(d),t[d]={node:u,lastCount:0},o[d]={};for(var f=0;f<a.length;f++){var m=a[f];t[m]&&t[m].node.mode===u.mode?(o[m][d]=p(t[m].lastCount+u.length,u.mode)-p(t[m].lastCount,u.mode),t[m].lastCount+=u.length):(t[m]&&(t[m].lastCount=u.length),o[m][d]=p(u.length,u.mode)+4+r.getCharCountIndicator(u.mode,n))}}a=s}for(f=0;f<a.length;f++)o[a[f]].end=0;return{map:o,table:t}}(function(e){for(var n=[],t=0;t<e.length;t++){var o=e[t];switch(o.mode){case r.NUMERIC:n.push([o,{data:o.data,mode:r.ALPHANUMERIC,length:o.length},{data:o.data,mode:r.BYTE,length:o.length}]);break;case r.ALPHANUMERIC:n.push([o,{data:o.data,mode:r.BYTE,length:o.length}]);break;case r.KANJI:n.push([o,{data:o.data,mode:r.BYTE,length:d(o.data)}]);break;case r.BYTE:n.push([{data:o.data,mode:r.BYTE,length:d(o.data)}])}}return n}(m(e,l.isKanjiModeEnabled())),t),a=u.find_path(o.map,"start","end"),i=[],c=1;c<a.length-1;c++)i.push(o.table[a[c]].node);return n.fromArray(function(e){return e.reduce((function(e,n){var t=e.length-1>=0?e[e.length-1]:null;return t&&t.mode===n.mode?(e[e.length-1].data+=n.data,e):(e.push(n),e)}),[])}(i))},n.rawSplit=function(e){return n.fromArray(m(e,l.isKanjiModeEnabled()))}},552:function(e,n,t){var r=t(106);function o(e){this.mode=r.NUMERIC,this.data=e.toString()}o.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(e){var n,t,r;for(n=0;n+3<=this.data.length;n+=3)t=this.data.substr(n,3),r=parseInt(t,10),e.put(r,10);var o=this.data.length-n;o>0&&(t=this.data.substr(n),r=parseInt(t,10),e.put(r,3*o+1))},e.exports=o},553:function(e,n,t){var r=t(106),o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(e){this.mode=r.ALPHANUMERIC,this.data=e}a.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){var n;for(n=0;n+2<=this.data.length;n+=2){var t=45*o.indexOf(this.data[n]);t+=o.indexOf(this.data[n+1]),e.put(t,11)}this.data.length%2&&e.put(o.indexOf(this.data[n]),6)},e.exports=a},554:function(e,n,t){var r=t(124),o=t(106);function a(e){this.mode=o.BYTE,this.data=r.from(e)}a.getBitsLength=function(e){return 8*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){for(var n=0,t=this.data.length;n<t;n++)e.put(this.data[n],8)},e.exports=a},555:function(e,n,t){var r=t(106),o=t(105);function a(e){this.mode=r.KANJI,this.data=e}a.getBitsLength=function(e){return 13*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){var n;for(n=0;n<this.data.length;n++){var t=o.toSJIS(this.data[n]);if(t>=33088&&t<=40956)t-=33088;else{if(!(t>=57408&&t<=60351))throw new Error("Invalid SJIS character: "+this.data[n]+"\nMake sure your charset is UTF-8");t-=49472}t=192*(t>>>8&255)+(255&t),e.put(t,13)}},e.exports=a},556:function(e,n,t){"use strict";var r={single_source_shortest_paths:function(e,n,t){var o={},a={};a[n]=0;var i,c,s,l,u,d,f,m=r.PriorityQueue.make();for(m.push(n,0);!m.empty();)for(s in c=(i=m.pop()).value,l=i.cost,u=e[c]||{})u.hasOwnProperty(s)&&(d=l+u[s],f=a[s],(void 0===a[s]||f>d)&&(a[s]=d,m.push(s,d),o[s]=c));if(void 0!==t&&void 0===a[t]){var p=["Could not find a path from ",n," to ",t,"."].join("");throw new Error(p)}return o},extract_shortest_path_from_predecessor_list:function(e,n){for(var t=[],r=n;r;)t.push(r),e[r],r=e[r];return t.reverse(),t},find_path:function(e,n,t){var o=r.single_source_shortest_paths(e,n,t);return r.extract_shortest_path_from_predecessor_list(o,t)},PriorityQueue:{make:function(e){var n,t=r.PriorityQueue,o={};for(n in e=e||{},t)t.hasOwnProperty(n)&&(o[n]=t[n]);return o.queue=[],o.sorter=e.sorter||t.default_sorter,o},default_sorter:function(e,n){return e.cost-n.cost},push:function(e,n){var t={value:e,cost:n};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=r},557:function(e,n,t){var r=t(365);n.render=function(e,n,t){var o=t,a=n;void 0!==o||n&&n.getContext||(o=n,n=void 0),n||(a=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),o=r.getOptions(o);var i=r.getImageWidth(e.modules.size,o),c=a.getContext("2d"),s=c.createImageData(i,i);return r.qrToImageData(s.data,e,o),function(e,n,t){e.clearRect(0,0,n.width,n.height),n.style||(n.style={}),n.height=t,n.width=t,n.style.height=t+"px",n.style.width=t+"px"}(c,a,i),c.putImageData(s,0,0),a},n.renderToDataURL=function(e,t,r){var o=r;void 0!==o||t&&t.getContext||(o=t,t=void 0),o||(o={});var a=n.render(e,t,o),i=o.type||"image/png",c=o.rendererOpts||{};return a.toDataURL(i,c.quality)}},558:function(e,n,t){var r=t(365);function o(e,n){var t=e.a/255,r=n+'="'+e.hex+'"';return t<1?r+" "+n+'-opacity="'+t.toFixed(2).slice(1)+'"':r}function a(e,n,t){var r=e+n;return void 0!==t&&(r+=" "+t),r}n.render=function(e,n,t){var i=r.getOptions(n),c=e.modules.size,s=e.modules.data,l=c+2*i.margin,u=i.color.light.a?"<path "+o(i.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+o(i.color.dark,"stroke")+' d="'+function(e,n,t){for(var r="",o=0,i=!1,c=0,s=0;s<e.length;s++){var l=Math.floor(s%n),u=Math.floor(s/n);l||i||(i=!0),e[s]?(c++,s>0&&l>0&&e[s-1]||(r+=i?a("M",l+t,.5+u+t):a("m",o,0),o=0,i=!1),l+1<n&&e[s+1]||(r+=a("h",c),c=0)):o++}return r}(s,c,i.margin)+'"/>',f='viewBox="0 0 '+l+" "+l+'"',m='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+f+' shape-rendering="crispEdges">'+u+d+"</svg>\n";return"function"==typeof t&&t(null,m),m}},59:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));t(8);function r(e,n,t,r){var o,a="collaborator_free_trial_7_days",i=window.open();"function"==typeof ga&&ga("send","event","subscription-funnel","upgraded-free-trial",e),o="/user/subscription/new?planCode=".concat(a,"&ssp=true"),o="".concat(o,"&itm_campaign=").concat(e),n&&(o="".concat(o,"&itm_content=").concat(n)),t&&(t.startedFreeTrial=!0),r&&r.sendMB("subscription-start-trial",{source:e,plan:a}),i.location=o}function o(e,n){var t=window.open();!function(){"function"==typeof ga&&ga("send","event","subscription-funnel","upgraded-plan",e);n&&(n.startedFreeTrial=!0),t.location="/user/subscription"}()}},71:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));t(9),t(25),t(85),t(7),t(31);var r=window.ExposedSettings.sentryDsn?Promise.resolve().then(t.bind(null,468)).then((function(e){var n=0;return e.init({dsn:window.ExposedSettings.sentryDsn,release:window.ExposedSettings.sentryRelease,whitelistUrls:[new RegExp(window.ExposedSettings.sentryAllowedOriginRegex)],ignoreErrors:['SecurityError: Permission denied to access property "pathname" on cross-origin object',/^Missing PDF/,/^AbortError/,"ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications."],beforeSend:function(e){return++n>100?null:e}}),e.setUser({id:window.user_id}),e})).catch(o):o();function o(){return Promise.resolve({captureException:function(e){console.error(e)},captureMessage:function(e){console.error(e)}})}function a(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];r.then((function(e){return e.captureException.apply(e,n)}))}function i(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];r.then((function(e){return e.captureMessage.apply(e,n)}))}},908:function(e,n,t){"use strict";t.r(n);t(6),t(7),t(34);var r=t(2);r.a.controller("TokenAccessPageController",["$scope","$http","$location","localStorage",function(e,n,t,r){window.S=e,e.mode="accessAttempt",e.v1ImportData=null,e.accessInFlight=!1,e.accessSuccess=!1,e.accessError=!1,e.currentPath=function(){return t.path()},e.buildZipDownloadPath=function(e){return"/overleaf/project/".concat(e,"/download/zip")},e.getProjectName=function(){return e.v1ImportData&&e.v1ImportData.name?e.v1ImportData.name:"This project"},e.post=function(){e.mode="accessAttempt";var t=$("#overleaf-token-access-data").text(),r=JSON.parse(t),o=r.postUrl,a=r.csrfToken;e.accessInFlight=!0,n({method:"POST",url:o,data:{_csrf:a}}).then((function(n){e.accessInFlight=!1,e.accessError=!1;var t=n.data;if(t.redirect){var r=n.data.redirect;if(!r)return console.warn("no redirect supplied in success response data",n),void(e.accessError=!0);window.location.replace(r)}else t.v1Import?(e.mode="v1Import",e.v1ImportData=t.v1Import):(console.warn("invalid data from server in success response",n),e.accessError=!0)}),(function(n){console.warn("error response from server",n),e.accessInFlight=!1,e.accessError=404===n.status?"not_found":"error"}))}}]);t(8),t(20),t(18),t(28),t(30),t(35),t(12),t(95),t(68),t(54);var o=t(3),a=t.n(o);r.a.service("ProjectListService",(function(){return{getOwnerName:function(e){return"owner"===e.accessLevel?"You":null!=e.owner?this.getUserName(e.owner):"None"},getUserName:function(e){if(e&&e._id===window.user_id)return"You";if(e){var n=e.first_name,t=e.last_name,r=e.email;return n||t?[n,t].filter((function(e){return null!=e})).join(" "):r||"An Overleaf v1 User"}return"None"}}}));function i(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw a}}}}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}r.a.controller("ProjectPageController",["$scope","$modal","$window","queuedHttp","eventTracking","$timeout","localStorage","ProjectListService",function(e,n,t,r,o,c,s,l){e.projects=window.data.projects,e.tags=window.data.tags,e.notifications=window.data.notifications,e.notificationsInstitution=window.data.notificationsInstitution,e.allSelected=!1,e.selectedProjects=[],e.filter="all",e.predicate="lastUpdated",e.nUntagged=0,e.reverse=!0,e.searchText={value:""},e.$watch("predicate",(function(n){e.comparator="ownerName"===n?f:d})),c((function(){return u()}),10),e.$watch((function(){return e.projects.filter((function(e){return!(null!=e.tags&&0!==e.tags.length||e.archived||e.trashed)})).length}),(function(n){return e.nUntagged=n}));var u=function(){var n=$(".project-list-card");if(n&&n.offset()){var r=n.offset().top,o=n.outerHeight()-n.height(),a=$("footer").outerHeight(),i=t.innerHeight-r-a-o;e.projectListHeight=i}};function d(n,t){var r=0,o=n.type,a=t.type;if("ownerName"!==e.predicate){if(o===a){var i=n.value,c=t.value;"string"===o?(i=i.toLowerCase(),c=c.toLowerCase()):"object"===o&&(angular.isObject(i)&&(i=n.index),angular.isObject(c)&&(c=t.index)),i!==c&&(r=i<c?-1:1)}else r=o<a?-1:1;return r}}function f(n,t){if("ownerName"===e.predicate)return"You"===n.value?"You"===t.value&&n.index<t.index?-1:1:"An Overleaf v1 User"===n.value||"None"===n.value?"An Overleaf v1 User"===t.value||"None"===t.value?n.index<t.index?-1:1:-1:"You"===t.value?-1:"An Overleaf v1 User"===t.value||"None"===t.value?1:n.value>t.value?-1:1}angular.element(t).bind("resize",(function(){u(),e.$apply()})),e.$on("project-list:notifications-received",(function(){return e.$applyAsync((function(){return u()}))}));var m,p={},h=i(e.projects);try{for(h.s();!(m=h.n()).done;){var g=m.value;p[g.id]=g}}catch(e){h.e(e)}finally{h.f()}e.getProjectById=function(e){return p[e]};var v,w=i(e.tags);try{for(w.s();!(v=w.n()).done;){var y,b=v.value,S=i(b.project_ids||[]);try{for(S.s();!(y=S.n()).done;){var C=y.value,T=p[C];T&&(T.tags||(T.tags=[]),T.tags.push(b))}}catch(e){S.e(e)}finally{S.f()}}}catch(e){w.e(e)}finally{w.f()}e.changePredicate=function(n){e.predicate===n&&(e.reverse=!e.reverse),e.predicate=n},e.getSortIconClass=function(n){return n===e.predicate&&e.reverse?"fa-caret-down":n!==e.predicate||e.reverse?"":"fa-caret-up"},e.searchProjects=function(){o.send("project-list-page-interaction","project-search","keydown"),e.updateVisibleProjects()},e.clearSearchText=function(){e.searchText.value="",e.filter="all",e.$emit("search:clear"),e.updateVisibleProjects()},e.setFilter=function(n){e.filter=n,e.updateVisibleProjects()},e.updateSelectedProjects=function(){e.selectedProjects=e.projects.filter((function(e){return e.selected}))},e.getSelectedProjects=function(){return e.selectedProjects},e.getSelectedProjectIds=function(){return e.selectedProjects.map((function(e){return e.id}))},e.getFirstSelectedProject=function(){return e.selectedProjects[0]},e.hasLeavableProjectsSelected=function(){return a.a.some(e.getSelectedProjects(),(function(e){return"owner"!==e.accessLevel&&e.trashed}))},e.hasDeletableProjectsSelected=function(){return a.a.some(e.getSelectedProjects(),(function(e){return"owner"===e.accessLevel&&e.trashed}))},e.updateVisibleProjects=function(){e.visibleProjects=[];var n,t=e.getSelectedTag(),r=i(e.projects);try{for(r.s();!(n=r.n()).done;){var o=n.value,a=!0;""!==e.searchText.value&&-1===o.name.toLowerCase().indexOf(e.searchText.value.toLowerCase())&&(a=!1),"tag"!==e.filter||null==t||t.project_ids.includes(o.id)||(a=!1),"untagged"===e.filter&&(null!=o.tags?o.tags.length:void 0)>0&&(a=!1),"shared"===e.filter&&"owner"===o.accessLevel&&(a=!1),"owned"===e.filter&&"owner"!==o.accessLevel&&(a=!1),"archived"===e.filter?o.archived||(a=!1):o.archived&&(a=!1),"trashed"===e.filter?o.trashed||(a=!1):o.trashed&&(a=!1),a?e.visibleProjects.push(o):o.selected=!1}}catch(e){r.e(e)}finally{r.f()}s("project_list",JSON.stringify({filter:e.filter,selectedTagId:null!=t?t._id:void 0})),e.updateSelectedProjects()},e.getSelectedTag=function(){var n,t=i(e.tags);try{for(t.s();!(n=t.n()).done;){var r=n.value;if(r.selected)return r}}catch(e){t.e(e)}finally{t.f()}return null},e._removeProjectIdsFromTagArray=function(e,n){var t,r=[],o=[],a=i(e.project_ids);try{for(a.s();!(t=a.n()).done;){var c=t.value;n.includes(c)?o.push(c):r.push(c)}}catch(e){a.e(e)}finally{a.f()}return e.project_ids=r,o},e._removeProjectFromList=function(n){var t=e.projects.indexOf(n);t>-1&&e.projects.splice(t,1)},e.removeSelectedProjectsFromTag=function(n){n.showWhenEmpty=!0;var t,o=e.getSelectedProjectIds(),a=e.getSelectedProjects(),c=e._removeProjectIdsFromTagArray(n,o),s=i(a);try{for(s.s();!(t=s.n()).done;){var l=t.value;l.tags||(l.tags=[]);var u=l.tags.indexOf(n);u>-1&&l.tags.splice(u,1)}}catch(e){s.e(e)}finally{s.f()}var d,f=i(c);try{for(f.s();!(d=f.n()).done;){var m=d.value;r({method:"DELETE",url:"/tag/".concat(n._id,"/project/").concat(m),headers:{"X-CSRF-Token":window.csrfToken}})}}catch(e){f.e(e)}finally{f.f()}e.updateVisibleProjects()},e.removeProjectFromTag=function(n,t){t.showWhenEmpty=!0,n.tags||(n.tags=[]);var o=n.tags.indexOf(t);o>-1&&(e._removeProjectIdsFromTagArray(t,[n.id]),n.tags.splice(o,1),r({method:"DELETE",url:"/tag/".concat(t._id,"/project/").concat(n.id),headers:{"X-CSRF-Token":window.csrfToken}}),e.updateVisibleProjects())},e.addSelectedProjectsToTag=function(n){var t=e.getSelectedProjects();o.send("project-list-page-interaction","project action","addSelectedProjectsToTag");var a,c=[],s=i(e.getSelectedProjectIds());try{for(s.s();!(a=s.n()).done;){var l=a.value;n.project_ids.includes(l)||(n.project_ids.push(l),c.push(l))}}catch(e){s.e(e)}finally{s.f()}var u,d=i(t);try{for(d.s();!(u=d.n()).done;){var f=u.value;f.tags||(f.tags=[]),f.tags.includes(n)||f.tags.push(n)}}catch(e){d.e(e)}finally{d.f()}for(var m=0,p=c;m<p.length;m++){var h=p[m];r.post("/tag/".concat(n._id,"/project/").concat(h),{_csrf:window.csrfToken})}},e.openNewTagModal=function(t){n.open({templateUrl:"newTagModalTemplate",controller:"NewTagModalController"}).result.then((function(n){e.tags.find((function(e){return n.name===e.name}))||(e.tags.push(n),e.addSelectedProjectsToTag(n))}))},e.createProject=function(n,t){return null==t&&(t="none"),r.post("/project/new",{_csrf:window.csrfToken,projectName:n,template:t}).then((function(t){var r=t.data;e.projects.push({name:n,_id:r.project_id,accessLevel:"owner",owner:r.owner}),e.updateVisibleProjects()}))},e.openCreateProjectModal=function(t){null==t&&(t="none"),o.send("project-list-page-interaction","new-project",t),n.open({templateUrl:"newProjectModalTemplate",controller:"NewProjectModalController",resolve:{template:function(){return t}},scope:e}).result.then((function(e){return window.location="/project/".concat(e)}))},e.renameProject=function(e,n){return r.post("/project/".concat(e.id,"/rename"),{newProjectName:n,_csrf:window.csrfToken}).then((function(){return e.name=n}))},e.openRenameProjectModal=function(){var t=e.getFirstSelectedProject();t&&"owner"===t.accessLevel&&(o.send("project-list-page-interaction","project action","Rename"),n.open({templateUrl:"renameProjectModalTemplate",controller:"RenameProjectModalController",resolve:{project:function(){return t}},scope:e}))},e.cloneProject=function(n,t){return o.send("project-list-page-interaction","project action","Clone"),r.post("/project/".concat(n.id,"/clone"),{_csrf:window.csrfToken,projectName:t}).then((function(n){var t=n.data;e.projects.push({name:t.name,id:t.project_id,accessLevel:"owner",owner:t.owner}),e.updateVisibleProjects()}))},e.openCloneProjectModal=function(t){t&&n.open({templateUrl:"cloneProjectModalTemplate",controller:"CloneProjectModalController",resolve:{project:function(){return t}},scope:e})};var P=function(e,t){return o.send("project-list-page-interaction","project action",e),n.open({templateUrl:"archiveTrashLeaveOrDeleteProjectsModalTemplate",controller:"ArchiveTrashLeaveOrDeleteProjectsModalController",resolve:{projects:function(){return t},action:function(){return e}}})};e.createArchiveProjectsModal=function(e){return P("archive",e)},e.createTrashProjectsModal=function(e){return P("trash",e)},e.createLeaveProjectsModal=function(e){return P("leave",e)},e.createDeleteProjectsModal=function(e){return P("delete",e)},e.createLeaveOrDeleteProjectsModal=function(e){return P("leaveOrDelete",e)},e.openArchiveProjectsModal=function(){e.createArchiveProjectsModal(e.getSelectedProjects()).result.then((function(){return e.archiveSelectedProjects()}))},e.openTrashProjectsModal=function(){e.createTrashProjectsModal(e.getSelectedProjects()).result.then((function(){return e.trashSelectedProjects()}))},e.openLeaveProjectsModal=function(){e.createLeaveProjectsModal(e.getSelectedProjects()).result.then((function(){return e.leaveSelectedProjects()}))},e.openDeleteProjectsModal=function(){e.createDeleteProjectsModal(e.getSelectedProjects()).result.then((function(){return e.deleteSelectedProjects()}))},e.openLeaveOrDeleteProjectsModal=function(){e.createLeaveOrDeleteProjectsModal(e.getSelectedProjects()).result.then((function(){return e.leaveOrDeleteSelectedProjects()}))},e.archiveSelectedProjects=function(){return e.archiveProjects(e.getSelectedProjects())},e.unarchiveSelectedProjects=function(){return e.unarchiveProjects(e.getSelectedProjects())},e.trashSelectedProjects=function(){return e.trashProjects(e.getSelectedProjects())},e.untrashSelectedProjects=function(){return e.untrashProjects(e.getSelectedProjects())},e.leaveSelectedProjects=function(){return e.leaveProjects(e.getSelectedProjects())},e.deleteSelectedProjects=function(){return e.deleteProjects(e.getSelectedProjects())},e.leaveOrDeleteSelectedProjects=function(){return e.leaveOrDeleteProjects(e.getSelectedProjects())},e.archiveProjects=function(n){var t,r=i(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.archived=!0,o.trashed=!1,E(o)}}catch(e){r.e(e)}finally{r.f()}e.updateVisibleProjects()},e.unarchiveProjects=function(n){var t,r=i(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.archived=!1,M(o)}}catch(e){r.e(e)}finally{r.f()}e.updateVisibleProjects()},e.trashProjects=function(n){var t,r=i(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.trashed=!0,o.archived=!1,j(o)}}catch(e){r.e(e)}finally{r.f()}e.updateVisibleProjects()},e.untrashProjects=function(n){var t,r=i(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.trashed=!1,A(o)}}catch(e){r.e(e)}finally{r.f()}e.updateVisibleProjects()},e.leaveProjects=function(n){_(n);var t,r=i(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;k(o)}}catch(e){r.e(e)}finally{r.f()}e.updateVisibleProjects()},e.deleteProjects=function(n){_(n);var t,r=i(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;I(o)}}catch(e){r.e(e)}finally{r.f()}e.updateVisibleProjects()},e.leaveOrDeleteProjects=function(n){_(n);var t,r=i(n);try{for(r.s();!(t=r.n()).done;){var o=t.value;"owner"===o.accessLevel?I(o):k(o)}}catch(e){r.e(e)}finally{r.f()}e.updateVisibleProjects()};var E=function(e){return r({method:"POST",url:"/project/".concat(e.id,"/archive"),headers:{"X-CSRF-Token":window.csrfToken}})},M=function(e){return r({method:"DELETE",url:"/project/".concat(e.id,"/archive"),headers:{"X-CSRF-Token":window.csrfToken}})},j=function(e){return r({method:"POST",url:"/project/".concat(e.id,"/trash"),headers:{"X-CSRF-Token":window.csrfToken}})},A=function(e){return r({method:"DELETE",url:"/project/".concat(e.id,"/trash"),headers:{"X-CSRF-Token":window.csrfToken}})},k=function(e){return r({method:"POST",url:"/project/".concat(e.id,"/leave"),headers:{"X-CSRF-Token":window.csrfToken}})},I=function(e){return r({method:"DELETE",url:"/project/".concat(e.id),headers:{"X-CSRF-Token":window.csrfToken}})},_=function(n){var t,r=n.map((function(e){return e.id})),o=i(e.tags||[]);try{for(o.s();!(t=o.n()).done;){var a=t.value;e._removeProjectIdsFromTagArray(a,r)}}catch(e){o.e(e)}finally{o.f()}var c,s=i(n||[]);try{for(s.s();!(c=s.n()).done;){var l=c.value;e._removeProjectFromList(l)}}catch(e){s.e(e)}finally{s.f()}};e.getValueForCurrentPredicate=function(n){return"ownerName"===e.predicate?l.getOwnerName(n):n[e.predicate]},e.openUploadProjectModal=function(){n.open({templateUrl:"uploadProjectModalTemplate",controller:"UploadProjectModalController"})},e.downloadSelectedProjects=function(){return e.downloadProjectsById(e.getSelectedProjectIds())},e.downloadProjectsById=function(e){var n;return o.send("project-list-page-interaction","project action","Download Zip"),n=e.length>1?"/project/download/zip?project_ids=".concat(e.join(",")):"/project/".concat(e[0],"/download/zip"),window.location=n};var U=JSON.parse(s("project_list"));U&&U.filter?("tag"===U.filter&&U.selectedTagId&&function(n){var t,r=i(e.tags);try{for(r.s();!(t=r.n()).done;){var o=t.value;o._id===n?o.selected=!0:o.selected=!1}}catch(e){r.e(e)}finally{r.f()}}(U.selectedTagId),e.setFilter(U.filter)):e.updateVisibleProjects()}]),r.a.controller("ProjectListItemController",["$scope","$modal","queuedHttp","ProjectListService",function(e,n,t,r){e.projectLink=function(e){return"/project/".concat(e.id)},e.isLinkSharingProject=function(e){return"token"===e.source},e.hasGenericOwnerName=function(){var n=e.project.owner,t=n.first_name,r=n.last_name,o=n.email;return!t&&!r&&!o},e.getOwnerName=r.getOwnerName,e.getUserName=r.getUserName,e.isOwner=function(){return e.project.owner&&window.user_id===e.project.owner._id},e.$watch("project.selected",(function(n){null!=n&&e.updateSelectedProjects()})),e.clone=function(n){n.stopPropagation(),e.openCloneProjectModal(e.project)},e.download=function(n){n.stopPropagation(),e.downloadProjectsById([e.project.id])},e.archive=function(n){n.stopPropagation(),e.createArchiveProjectsModal([e.project]).result.then((function(){e.archiveProjects([e.project])}))},e.unarchive=function(n){n.stopPropagation(),e.unarchiveProjects([e.project])},e.trash=function(n){n.stopPropagation(),e.createTrashProjectsModal([e.project]).result.then((function(){e.trashProjects([e.project])}))},e.untrash=function(n){n.stopPropagation(),e.untrashProjects([e.project])},e.leave=function(n){n.stopPropagation(),e.createLeaveProjectsModal([e.project]).result.then((function(){e.leaveProjects([e.project])}))},e.delete=function(n){n.stopPropagation(),e.createDeleteProjectsModal([e.project]).result.then((function(){e.deleteProjects([e.project])}))}}]),r.a.controller("RenameProjectModalController",["$scope","$modalInstance","$timeout","project","queuedHttp",function(e,n,t,r,o){return e.inputs={projectName:r.name},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.rename=function(){return e.state.inflight=!0,e.state.error=!1,e.renameProject(r,e.inputs.projectName).then((function(){return e.state.inflight=!1,e.state.error=!1,n.close()})).catch((function(n){var t=n.data,r=n.status;return e.state.inflight=!1,e.state.error=400!==r||{message:t}}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("CloneProjectModalController",["$scope","$modalInstance","$timeout","project",function(e,n,t,r){return e.inputs={projectName:r.name+" (Copy)"},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.clone=function(){return e.state.inflight=!0,e.cloneProject(r,e.inputs.projectName).then((function(){return e.state.inflight=!1,e.state.error=!1,n.close()})).catch((function(n){var t=n.data,r=n.status;return e.state.inflight=!1,e.state.error=400!==r||{message:t}}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("NewProjectModalController",["$scope","$modalInstance","$timeout","template",function(e,n,t,r){return e.inputs={projectName:""},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.create=function(){return e.state.inflight=!0,e.state.error=!1,e.createProject(e.inputs.projectName,r).then((function(t){var r=t.data;return e.state.inflight=!1,e.state.error=!1,n.close(r.project_id)})).catch((function(n){var t=n.data,r=n.status;return e.state.inflight=!1,e.state.error=400!==r||{message:t}}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("ArchiveTrashLeaveOrDeleteProjectsModalController",["$scope","$modalInstance","$timeout","projects","action",function(e,n,t,r,o){e.projects=r,e.action=o,e.confirm=function(){return n.close({projects:r,action:o})},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("UploadProjectModalController",["$scope","$modalInstance","$timeout",function(e,n,t){return e.cancel=function(){return n.dismiss("cancel")},e.onComplete=function(e,n,t){if(null!=t.project_id)return window.location="/project/".concat(t.project_id)}}]),r.a.controller("V1ImportModalController",["$scope","$modalInstance","project",function(e,n,t){return e.project=t,e.dismiss=function(){return n.dismiss("cancel")}}]);r.a.controller("ShowErrorModalController",["$scope","$modalInstance","error",function(e,n,t){return e.error=t,e.cancel=function(){return n.dismiss("cancel")}}]),t(45),t(101),t(46);var s=t(33);function l(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return u(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return u(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}r.a.controller("TagListController",["$scope","$modal",function(e,n){e.filterProjects=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";e._clearTags(),e.setFilter(n)},e._clearTags=function(){return e.tags.forEach((function(e){e.selected=!1}))},e.selectTag=function(n){e._clearTags(),n.selected=!0,e.setFilter("tag")},e.selectUntagged=function(){e._clearTags(),e.setFilter("untagged")},e.countProjectsForTag=function(n){return n.project_ids.reduce((function(n,t){var r=e.getProjectById(t);return r?r.archived||r.trashed?n:n+1:n}),0)},e.getHueForTagId=function(e){return s.a.getHueForTagId(e)},e.deleteTag=function(t){n.open({templateUrl:"deleteTagModalTemplate",controller:"DeleteTagModalController",resolve:{tag:function(){return t}}}).result.then((function(){var n,r=l(e.projects);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.tags||(o.tags=[]);var a=o.tags.indexOf(t);a>-1&&o.tags.splice(a,1)}}catch(e){r.e(e)}finally{r.f()}e.tags.splice(e.tags.indexOf(t),1)}))},e.renameTag=function(e){n.open({templateUrl:"renameTagModalTemplate",controller:"RenameTagModalController",resolve:{tag:function(){return e}}}).result.then((function(n){return e.name=n}))}}]),r.a.controller("TagDropdownItemController",["$scope",function(e){e.recalculateProjectsInTag=function(){var n;e.areSelectedProjectsInTag=!1;var t,r=l(e.getSelectedProjectIds());try{for(r.s();!(t=r.n()).done;){var o=t.value;e.tag.project_ids.includes(o)?e.areSelectedProjectsInTag=!0:n=!0}}catch(e){r.e(e)}finally{r.f()}e.areSelectedProjectsInTag&&n&&(e.areSelectedProjectsInTag="partial")},e.addOrRemoveProjectsFromTag=function(){!0===e.areSelectedProjectsInTag?(e.removeSelectedProjectsFromTag(e.tag),e.areSelectedProjectsInTag=!1):!1!==e.areSelectedProjectsInTag&&"partial"!==e.areSelectedProjectsInTag||(e.addSelectedProjectsToTag(e.tag),e.areSelectedProjectsInTag=!0)},e.$watch("selectedProjects",(function(){return e.recalculateProjectsInTag()})),e.recalculateProjectsInTag()}]),r.a.controller("NewTagModalController",["$scope","$modalInstance","$timeout","$http",function(e,n,t,r){e.inputs={newTagName:""},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.create=function(){var t=e.inputs.newTagName;e.state.inflight=!0,e.state.error=!1,r.post("/tag",{_csrf:window.csrfToken,name:t}).then((function(t){var r=t.data;e.state.inflight=!1,n.close(r)})).catch((function(){e.state.inflight=!1,e.state.error=!0}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("RenameTagModalController",["$scope","$modalInstance","$timeout","$http","tag",function(e,n,t,r,o){e.inputs={tagName:o.name},e.state={inflight:!1,error:!1},n.opened.then((function(){return t((function(){return e.$broadcast("open")}),200)})),e.rename=function(){var t=e.inputs.tagName;return e.state.inflight=!0,e.state.error=!1,r.post("/tag/".concat(o._id,"/rename"),{_csrf:window.csrfToken,name:t}).then((function(){e.state.inflight=!1,n.close(t)})).catch((function(){e.state.inflight=!1,e.state.error=!0}))},e.cancel=function(){return n.dismiss("cancel")}}]);r.a.controller("DeleteTagModalController",["$scope","$modalInstance","$http","tag",function(e,n,t,r){e.tag=r,e.state={inflight:!1,error:!1},e.delete=function(){return e.state.inflight=!0,e.state.error=!1,t({method:"DELETE",url:"/tag/".concat(r._id),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.state.inflight=!1,n.close()})).catch((function(){e.state.inflight=!1,e.state.error=!0}))},e.cancel=function(){return n.dismiss("cancel")}}]),t(9),t(25),t(39);function d(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var m=window.ExposedSettings;r.a.controller("NotificationsController",["$scope","$http",function(e,n){var t,r=d(e.notifications||[]);try{for(r.s();!(t=r.n()).done;){t.value.hide=!1}}catch(e){r.e(e)}finally{r.f()}e.samlInitPath=m.samlInitPath,e.dismiss=function(e){e._id?n({url:"/notifications/".concat(e._id),method:"DELETE",headers:{"X-Csrf-Token":window.csrfToken}}).then((function(){return e.hide=!0})):e.hide=!0}}]),r.a.controller("DismissableNotificationsController",["$scope","localStorage",function(e,n){e.shouldShowNotification=!0!==n("dismissed-covid-19-notification-extended"),e.dismiss=function(){n("dismissed-covid-19-notification-extended",!0),e.shouldShowNotification=!1}}]),r.a.controller("ProjectInviteNotificationController",["$scope","$http",function(e,n){e.projectName=e.notification.messageOpts.projectName,e.userName=e.notification.messageOpts.userName,e.accept=function(){return e.notification.inflight=!0,n({url:"/project/".concat(e.notification.messageOpts.projectId,"/invite/token/").concat(e.notification.messageOpts.token,"/accept"),method:"POST",headers:{"X-Csrf-Token":window.csrfToken,"X-Requested-With":"XMLHttpRequest"}}).then((function(){e.notification.accepted=!0})).catch((function(n){404===n.status?e.notification.accepted=!0:e.notification.error=!0})).finally((function(){e.notification.inflight=!1}))}}]),r.a.controller("EmailNotificationController",["$scope","$http","UserAffiliationsDataService",function(e,n,t){e.userEmails=window.data.userEmails;e.showConfirmEmail=function(e){return!m.emailConfirmationDisabled&&(!e.confirmedAt&&!e.hide&&!function(e){return!!m.hasSamlFeature&&(!!e.samlProviderId||!(!e.affiliation||!e.affiliation.institution)&&(!!e.affiliation.institution.ssoEnabled||!(!m.hasSamlBeta||!e.affiliation.institution.ssoBeta)))}(e))};var r,o=d(e.userEmails);try{for(o.s();!(r=o.n()).done;){r.value.hide=!1}}catch(e){o.e(e)}finally{o.f()}e.resendConfirmationEmail=function(n){n.confirmationInflight=!0,n.error=!1,n.errorMessage=null,t.resendConfirmationEmail(n.email).then((function(){n.hide=!0,e.$emit("project-list:notifications-received")})).catch((function(t){n.error=!0,n.errorMessage=t.data.message,console.error(t),e.$emit("project-list:notifications-received")})).finally((function(){n.confirmationInflight=!1}))}}]);r.a.controller("LeftHandMenuPromoController",["$scope","UserAffiliationsDataService","eventTracking",function(e,n,t){e.hasProjects=window.data.projects.length>0,e.userHasNoSubscription=window.userHasNoSubscription,e.upgradeSubscription=function(){t.send("subscription-funnel","project-page","upgrade")},e.share=function(){t.send("subscription-funnel","project-page","sharing")};e.withAffiliations=window.data.userAffiliations.length>0,e.userOnPayingUniversity=window.data.userAffiliations.some((function(e){return e.licence&&"free"!==e.licence}))}]),t(177);r.a.controller("AccountSettingsController",["$scope","$http","$modal","eventTracking","UserAffiliationsDataService",function(e,n,t,r,o){e.subscribed=!0,e.unsubscribe=function(){return e.unsubscribing=!0,n({method:"DELETE",url:"/user/newsletter/unsubscribe",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.unsubscribing=!1,e.subscribed=!1})).catch((function(){return e.unsubscribing=!0}))},e.deleteAccount=function(){t.open({templateUrl:"deleteAccountModalTemplate",controller:"DeleteAccountModalController",resolve:{userDefaultEmail:function(){return o.getUserDefaultEmail().then((function(e){return(null!=e?e.email:void 0)||null})).catch((function(){return null}))}}})},e.upgradeIntegration=function(e){return r.send("subscription-funnel","settings-page",e)}}]),r.a.controller("DeleteAccountModalController",["$scope","$modalInstance","$timeout","$http","userDefaultEmail",function(e,n,t,r,o){e.state={isValid:!1,deleteText:"",password:"",confirmSharelatexDelete:!1,inflight:!1,error:null},e.userDefaultEmail=o,n.opened.then((function(){return t((function(){return e.$broadcast("open")}),700)})),e.checkValidation=function(){return e.state.isValid=null!=o&&e.state.deleteText.toLowerCase()===o.toLowerCase()&&e.state.password.length>0&&e.state.confirmSharelatexDelete},e.delete=function(){return e.state.inflight=!0,e.state.error=null,r({method:"POST",url:"/user/delete",headers:{"X-CSRF-Token":window.csrfToken,"Content-Type":"application/json"},data:{password:e.state.password},disableAutoLoginRedirect:!0}).then((function(){n.close(),e.state.inflight=!1,e.state.error=null,setTimeout((function(){return window.location="/login"}),1e3)})).catch((function(n){var t=n.data,r=n.status;e.state.inflight=!1,403===r?e.state.error={code:"InvalidCredentialsError"}:t.error?e.state.error={code:t.error}:e.state.error={code:"UserDeletionError"}}))},e.cancel=function(){return n.dismiss("cancel")}}]);var p=t(22);r.a.controller("ClearSessionsController",["$scope","$http",function(e,n){return e.state={otherSessions:Object(p.a)("ol-otherSessions"),error:!1,success:!1},e.clearSessions=function(){return console.log(">> clearing all sessions"),n({method:"POST",url:"/user/sessions/clear",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return e.state.otherSessions=[],e.state.error=!1,e.state.success=!0})).catch((function(){return e.state.error=!0}))}}]),t(243),t(62);r.a.factory("MultiCurrencyPricing",(function(){return{currencyCode:Object(p.a)("ol-recomendedCurrency"),plans:{USD:{symbol:"$",student:{monthly:"$8",annual:"$80"},personal:{monthly:"$10",annual:"$120"},collaborator:{monthly:"$15",annual:"$180"},professional:{monthly:"$30",annual:"$360"}},EUR:{symbol:"€",student:{monthly:"€7",annual:"€70"},personal:{monthly:"€9",annual:"€108"},collaborator:{monthly:"€14",annual:"€168"},professional:{monthly:"€28",annual:"€336"}},GBP:{symbol:"£",student:{monthly:"£6",annual:"£60"},personal:{monthly:"£8",annual:"£96"},collaborator:{monthly:"£12",annual:"£144"},professional:{monthly:"£24",annual:"£288"}},SEK:{symbol:"kr",student:{monthly:"60 kr",annual:"600 kr"},personal:{monthly:"73 kr",annual:"876 kr"},collaborator:{monthly:"110 kr",annual:"1320 kr"},professional:{monthly:"220 kr",annual:"2640 kr"}},CAD:{symbol:"$",student:{monthly:"$9",annual:"$90"},personal:{monthly:"$11",annual:"$132"},collaborator:{monthly:"$17",annual:"$204"},professional:{monthly:"$34",annual:"$408"}},NOK:{symbol:"kr",student:{monthly:"60 kr",annual:"600 kr"},personal:{monthly:"73 kr",annual:"876 kr"},collaborator:{monthly:"110 kr",annual:"1320 kr"},professional:{monthly:"220 kr",annual:"2640 kr"}},DKK:{symbol:"kr",student:{monthly:"50 kr",annual:"500 kr"},personal:{monthly:"60 kr",annual:"720 kr"},collaborator:{monthly:"90 kr",annual:"1080 kr"},professional:{monthly:"180 kr",annual:"2160 kr"}},AUD:{symbol:"$",student:{monthly:"$10",annual:"$100"},personal:{monthly:"$12",annual:"$144"},collaborator:{monthly:"$18",annual:"$216"},professional:{monthly:"$35",annual:"$420"}},NZD:{symbol:"$",student:{monthly:"$10",annual:"$100"},personal:{monthly:"$12",annual:"$144"},collaborator:{monthly:"$18",annual:"$216"},professional:{monthly:"$35",annual:"$420"}},CHF:{symbol:"Fr",student:{monthly:"Fr 8",annual:"Fr 80"},personal:{monthly:"Fr 10",annual:"Fr 120"},collaborator:{monthly:"Fr 15",annual:"Fr 180"},professional:{monthly:"Fr 30",annual:"Fr 360"}},SGD:{symbol:"$",student:{monthly:"$12",annual:"$120"},personal:{monthly:"$13",annual:"$156"},collaborator:{monthly:"$20",annual:"$240"},professional:{monthly:"$40",annual:"$480"}}}}})),r.a.controller("PlansController",["$scope","$modal","eventTracking","MultiCurrencyPricing","$http","$filter","$location",function(e,n,t,r,o,a,i){e.plans=r.plans,e.currencyCode=r.currencyCode,e.trial_len=7,e.planQueryString="_free_trial_7_days",e.ui={view:"monthly"},e.changeCurreny=function(n,t){n.preventDefault(),e.currencyCode=t},e.getCollaboratorPlanCode=function(){return"annual"===e.ui.view?"collaborator-annual":"collaborator".concat(e.planQueryString)},e.getPersonalPlanCode=function(){return"annual"===e.ui.view?"paid-personal-annual":"paid-personal".concat(e.planQueryString)},e.signUpNowClicked=function(n,r){"annual"===e.ui.view&&(n="".concat(n,"_annual")),n=c(n,r),t.sendMB("plans-page-start-trial"),t.send("subscription-funnel","sign_up_now_button",n)},e.switchToMonthly=function(n,t){s(n,"monthly-prices",t),e.ui.view="monthly"},e.switchToStudent=function(n,t){s(n,"student-prices",t),e.ui.view="student"},e.switchToAnnual=function(n,t){s(n,"annual-prices",t),e.ui.view="annual"},e.openGroupPlanModal=function(){var e="".concat(window.location.pathname).concat(window.location.search);history.replaceState(null,document.title,e+"#groups"),n.open({templateUrl:"groupPlanModalPurchaseTemplate",controller:"GroupPlansModalPurchaseController"}).result.finally((function(){return history.replaceState(null,document.title,window.location.pathname)})),t.send("subscription-funnel","plans-page","group-inquiry-potential")},"groups"===i.hash()&&e.openGroupPlanModal();var c=function(e,n){return e};function s(e,n,r){e.preventDefault();var o=c(n,r);t.send("subscription-funnel","plans-page",o)}}]),r.a.controller("GroupPlansModalPurchaseController",["$scope","$modal","$location","$httpParamSerializer",function(e,n,t,r){e.options={plan_codes:[{display:"Collaborator",code:"collaborator"},{display:"Professional",code:"professional"}],currencies:[{display:"USD ($)",code:"USD"},{display:"GBP (£)",code:"GBP"},{display:"EUR (€)",code:"EUR"}],currencySymbols:{USD:"$",EUR:"€",GBP:"£"},sizes:[2,3,4,5,10,20,50],usages:[{display:"Enterprise",code:"enterprise"},{display:"Educational",code:"educational"}]},e.prices=Object(p.a)("ol-groupPlans");var o="USD",a=Object(p.a)("ol-recomendedCurrency");if(["USD","GBP","EUR"].includes(a)&&(o=a),e.selected={plan_code:"collaborator",currency:o,size:"10",usage:"enterprise"},t.search()){if(t.search().usage&&e.options.usages.forEach((function(n){n.code===t.search().usage&&(e.selected.usage=n.code)})),t.search().plan&&e.options.plan_codes.forEach((function(n){n.code===t.search().plan&&(e.selected.plan_code=n.code)})),t.search().number){var i=parseInt(t.search().number,10);-1!==e.options.sizes.indexOf(i)&&(e.selected.size=t.search().number)}t.search().currency&&e.options.currencies.forEach((function(n){n.code===t.search().currency&&(e.selected.currency=n.code)}))}e.recalculatePrice=function(){var n=e.selected,t=n.usage,r=n.plan_code,o=n.currency,a=n.size,i=e.prices[t][r][o][a],c=e.options.currencySymbols[o];e.displayPrice="".concat(c).concat(i)},e.$watch("selected",e.recalculatePrice,!0),e.recalculatePrice(),e.purchase=function(){var n=e.selected,o=n.plan_code,a=n.size,i=n.usage,c=n.currency,s={planCode:"group_".concat(o,"_").concat(a,"_").concat(i),currency:c,itm_campaign:"groups"};t.search().itm_content&&(s.itm_content=t.search().itm_content),window.location="/user/subscription/new?".concat(r(s))}}]);t(57),r.a.controller("PostGatewayController",["$scope",function(e){e.handleGateway=function(){var e=JSON.parse($("#gateway-data").text()).params;e.viaGateway="true",Object.keys(e).forEach((function(n){$("<input>").attr({type:"hidden",name:n,value:e[n]}).appendTo("#gateway")})),$("#gateway").submit()}}]),t(13),t(11),t(23),t(76);r.a.controller("UserMembershipController",["$scope","queuedHttp",function(e,n){e.users=window.users,e.groupSize=window.groupSize,e.paths=window.paths,e.selectedUsers=[],e.inputs={addMembers:{content:"",error:!1,errorMessage:null,inflightCount:0},removeMembers:{error:!1,errorMessage:null}};return e.addMembers=function(){e.inputs.addMembers.error=!1,e.inputs.addMembers.errorMessage=null,e.inputs.addMembers.inflightCount=0;var t=function(e){var n=e.split(/[\s,]+/);return n=a.a.map(n,(function(e){return e.trim()})),n=a.a.filter(n,(function(e){return-1!==e.indexOf("@")}))}(e.inputs.addMembers.content);return Array.from(t).map((function(t){return e.inputs.addMembers.inflightCount+=1,n.post(window.paths.addMember,{email:t,_csrf:window.csrfToken}).then((function(n){e.inputs.addMembers.inflightCount-=1;var t=n.data;return null!=t.user&&e.users.push(t.user),e.inputs.addMembers.content=""})).catch((function(n){e.inputs.addMembers.inflightCount-=1;var t=n.data;return e.inputs.addMembers.error=!0,e.inputs.addMembers.errorMessage=null!=t.error?t.error.message:void 0}))}))},e.removeMembers=function(){e.inputs.removeMembers.error=!1,e.inputs.removeMembers.errorMessage=null;for(var t=0,r=Array.from(e.selectedUsers);t<r.length;t++){!function(t){var r;if(window.paths.removeInvite&&t.invite&&null==t._id)r="".concat(window.paths.removeInvite,"/").concat(encodeURIComponent(t.email));else{if(!window.paths.removeMember||null==t._id)return;r="".concat(window.paths.removeMember,"/").concat(t._id)}n({method:"DELETE",url:r,headers:{"X-Csrf-Token":window.csrfToken}}).then((function(){var n=e.users.indexOf(t);if(-1!==n)return e.users.splice(n,1)})).catch((function(n){var t=n.data;return e.inputs.removeMembers.error=!0,e.inputs.removeMembers.errorMessage=null!=t.error?t.error.message:void 0}))}(r[t])}return e.updateSelectedUsers},e.updateSelectedUsers=function(){return e.selectedUsers=e.users.filter((function(e){return e.selected}))}}]);r.a.controller("UserMembershipListItemController",["$scope",function(e){return e.$watch("user.selected",(function(n){if(null!=n)return e.updateSelectedUsers()}))}]),r.a.controller("ScribtexPopupController",["$scope","$modal",function(e,n){return n.open({templateUrl:"scribtexModalTemplate"})}]),t(244);r.a.controller("BonusLinksController",["$scope","$modal",function(e,n){return e.openLinkToUsModal=function(){return n.open({templateUrl:"BonusLinkToUsModal",controller:"BonusModalController"})}}]);r.a.controller("BonusModalController",["$scope","$modalInstance",function(e,n){return e.cancel=function(){return n.dismiss()}}]),t(245);r.a.controller("TranslationsPopupController",["$scope","ipCookie","localStorage",function(e,n,t){e.hidei18nNotification=function(){var e=t("hide-i18n-notification");if(null===e){var r=n("hidei18nNotification");return r&&(t("hide-i18n-notification",r),n.remove("hidei18nNotification")),r}return e}(),e.dismiss=function(){t("hide-i18n-notification",!0),e.hidei18nNotification=!0}}]);t(352);var h=a.a.once((function(){return!("undefined"==typeof recurly||!recurly)&&(recurly.configure(Object(p.a)("ol-recurlyApiKey")),!0)}));r.a.controller("MetricsEmailController",["$scope","$http",function(e,n){e.institutionEmailSubscription=function(e){return a.a.find(window.managedInstitutions,(function(n){return n.v1Id===parseInt(e)})).metricsEmail.optedOutUserIds.includes(window.user_id)?"Subscribe":"Unsubscribe"},e.changeInstitutionalEmailSubscription=function(t){return e.subscriptionChanging=!0,n({method:"POST",url:"/institutions/".concat(t,"/emailSubscription"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(n){window.managedInstitutions=a.a.map(window.managedInstitutions,(function(e){return e.v1Id===parseInt(t)&&(e.metricsEmail.optedOutUserIds=n.data),e})),e.subscriptionChanging=!1}))}}]),r.a.factory("RecurlyPricing",["$q","MultiCurrencyPricing",function(e,n){return{loadDisplayPriceWithTax:function(t,r,o){if(h()){var a=n.plans[r].symbol,i=recurly.Pricing();return e((function(e,n){i.plan(t,{quantity:1}).currency(r).done((function(n){var t=parseFloat(n.next.total),r=t*o;isNaN(r)&&(r=0);var i=t+r;i%1!=0&&(i=i.toFixed(2)),e("".concat(a).concat(i))}))}))}}}}]),r.a.controller("ChangePlanFormController",["$scope","$modal","RecurlyPricing",function(e,n,t){h()&&(e.changePlan=function(){return n.open({templateUrl:"confirmChangePlanModalTemplate",controller:"ConfirmChangePlanController",scope:e})},e.cancelPendingPlanChange=function(){return n.open({templateUrl:"cancelPendingPlanChangeModalTemplate",controller:"CancelPendingPlanChangeController",scope:e})},e.$watch("plan",(function(n){if(n){var r=Object(p.a)("ol-planCodesChangingAtTermEnd");e.planChangesAtTermEnd=!1,r&&r.indexOf(n.planCode)>-1&&(e.planChangesAtTermEnd=!0);var o=n.planCode,a=Object(p.a)("ol-subscription").recurly,i=a.currency,c=a.taxRate;e.price="...",t.loadDisplayPriceWithTax(o,i,c).then((function(n){e.price=n}))}})))}]),r.a.controller("ConfirmChangePlanController",["$scope","$modalInstance","$http",function(e,n,t){return e.confirmChangePlan=function(){var n={plan_code:e.plan.planCode,_csrf:window.csrfToken};return e.inflight=!0,t.post("".concat("/user/subscription/update","?origin=confirmChangePlan"),n).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("CancelPendingPlanChangeController",["$scope","$modalInstance","$http",function(e,n,t){return e.confirmCancelPendingPlanChange=function(){var n={_csrf:window.csrfToken};return e.inflight=!0,t.post("/user/subscription/cancel-pending",n).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong reverting pending plan change")}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("LeaveGroupModalController",["$scope","$modalInstance","$http",function(e,n,t){return e.confirmLeaveGroup=function(){return e.inflight=!0,t({url:"/subscription/group/user",method:"DELETE",params:{subscriptionId:e.subscriptionId,_csrf:window.csrfToken}}).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("GroupMembershipController",["$scope","$modal",function(e,n){e.removeSelfFromGroup=function(t){return e.subscriptionId=t,n.open({templateUrl:"LeaveGroupModalTemplate",controller:"LeaveGroupModalController",scope:e})}}]),r.a.controller("RecurlySubscriptionController",["$scope",function(e){var n=h(),t=Object(p.a)("ol-subscription");e.showChangePlanButton=n&&!t.groupPlan,window.subscription.recurly.account.has_past_due_invoice&&"true"===window.subscription.recurly.account.has_past_due_invoice._&&(e.showChangePlanButton=!1),e.recurlyLoadError=!n,e.switchToDefaultView=function(){e.showCancellation=!1,e.showChangePlan=!1},e.switchToDefaultView(),e.switchToCancellationView=function(){e.showCancellation=!0,e.showChangePlan=!1},e.switchToChangePlanView=function(){e.showCancellation=!1,e.showChangePlan=!0}}]),r.a.controller("RecurlyCancellationController",["$scope","RecurlyPricing","$http",function(e,n,t){if(h()){var r=Object(p.a)("ol-subscription"),o=new Date;o.setDate(o.getDate()+7);var a=new Date(r.recurly.trial_ends_at),i=a>new Date,c=a<o,s=-1!==r.plan.planCode.indexOf("collaborator")&&-1===r.plan.planCode.indexOf("ann")&&!r.groupPlan,l=i&&c;s&&l?e.showExtendFreeTrial=!0:s&&!l?e.showDowngradeToStudent=!0:e.showBasicCancel=!0;var u=r.recurly,d=u.currency,f=u.taxRate;e.studentPrice="...",n.loadDisplayPriceWithTax("student",d,f).then((function(n){e.studentPrice=n})),e.downgradeToStudent=function(){var n={plan_code:"student",_csrf:window.csrfToken};return e.inflight=!0,t.post("".concat("/user/subscription/update","?origin=downgradeToStudent"),n).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))},e.cancelSubscription=function(){var n={_csrf:window.csrfToken};return e.inflight=!0,t.post("/user/subscription/cancel",n).then((function(){return location.href="/user/subscription/canceled"})).catch((function(){return console.log("something went wrong changing plan")}))},e.extendTrial=function(){var n={_csrf:window.csrfToken};return e.inflight=!0,t.put("/user/subscription/extend",n).then((function(){return location.reload()})).catch((function(){return console.log("something went wrong changing plan")}))}}}]);r.a.controller("NewSubscriptionController",["$scope","MultiCurrencyPricing","$http","$location","eventTracking",function(e,n,t,r,o){if(window.couponCode=r.search().cc||"",window.plan_code=r.search().planCode||"",window.ITMCampaign=r.search().itm_campaign||"",window.ITMContent=r.search().itm_content||"","undefined"!=typeof recurly&&recurly){e.ui={addCompanyDetails:!1},e.recurlyLoadError=!1,e.currencyCode=n.currencyCode,e.allCurrencies=n.plans,e.availableCurrencies={},e.planCode=window.plan_code,e.switchToStudent=function(){var n=window.plan_code.replace("collaborator","student");o.sendMB("subscription-form-switch-to-student",{plan:window.plan_code}),o.send("subscription-funnel","subscription-form-switch-to-student",window.plan_code),window.location="/user/subscription/new?planCode=".concat(n,"&currency=").concat(e.currencyCode,"&cc=").concat(e.data.coupon,"&itm_campaign=").concat(window.ITMCampaign,"&itm_content=").concat(window.ITMContent)},o.sendMB("subscription-form",{plan:window.plan_code}),o.send("subscription-funnel","subscription-form-viewed",window.plan_code),e.paymentMethod={value:"credit_card"},e.data={first_name:"",last_name:"",postal_code:"",address1:"",address2:"",state:"",city:"",company:"",vat_number:"",country:Object(p.a)("ol-countryCode"),coupon:window.couponCode},e.validation={},e.processing=!1,e.threeDSecureFlow=!1,e.threeDSecureContainer=document.querySelector(".three-d-secure-container"),e.threeDSecureRecurlyContainer=document.querySelector(".three-d-secure-recurly-container"),recurly.configure({publicKey:Object(p.a)("ol-recurlyApiKey"),style:{all:{fontFamily:'"Open Sans", sans-serif',fontSize:"16px",fontColor:"#7a7a7a"},month:{placeholder:"MM"},year:{placeholder:"YY"},cvv:{placeholder:"CVV"}}});var i,c=recurly.Pricing();window.pricing=c,c.plan(window.plan_code,{quantity:1}).address({country:e.data.country}).tax({tax_code:"digital",vat_number:""}).currency(e.currencyCode).coupon(e.data.coupon).done(),c.on("change",(function(){for(var t in e.planName=c.items.plan.name,c.items.plan.trial&&(e.trialLength=c.items.plan.trial.length),e.price=e.trialLength?c.price.next:c.price.now,e.taxes=c.price.taxes,e.monthlyBilling=1===c.items.plan.period.length,e.availableCurrencies={},c.items.plan.price)n.plans[t]&&(e.availableCurrencies[t]=n.plans[t]);if(c.items&&c.items.coupon&&c.items.coupon.discount&&"percent"===c.items.coupon.discount.type){var r=parseInt(c.price.base.plan.unit,10);e.coupon={singleUse:c.items.coupon.single_use,normalPrice:r},c.items.coupon.applies_for_months>0&&c.items.coupon.discount.rate&&c.items.coupon.applies_for_months&&(e.coupon.discountMonths=c.items.coupon.applies_for_months,e.coupon.discountRate=100*c.items.coupon.discount.rate),c.price.taxes[0]&&c.price.taxes[0].rate&&(e.coupon.normalPrice+=r*c.price.taxes[0].rate)}else e.coupon=null;e.$apply()})),e.applyCoupon=function(){return c.coupon(e.data.coupon).done()},e.applyVatNumber=function(){return c.tax({tax_code:"digital",vat_number:e.data.vat_number}).done()},e.changeCurrency=function(n){return e.currencyCode=n,c.currency(n).done()},e.inputHasError=function(e){return null!=e&&(e.$touched&&e.$invalid)},e.isFormValid=function(n){return"paypal"===e.paymentMethod.value?""!==e.data.country:n.$valid},e.updateCountry=function(){return c.address({country:e.data.country}).done()},e.setPaymentMethod=function(n){e.paymentMethod.value=n,e.validation.errorFields={},e.genericError=""};var s=function(n,r,s){if(r&&(i=r),e.validation.errorFields={},null==n){var u={_csrf:window.csrfToken,recurly_token_id:i.id,recurly_three_d_secure_action_result_token_id:s&&s.id,subscriptionDetails:{currencyCode:c.items.currency,plan_code:c.items.plan.code,coupon_code:c.items.coupon?c.items.coupon.code:"",first_name:e.data.first_name,last_name:e.data.last_name,isPaypal:"paypal"===e.paymentMethod.value,address:{address1:e.data.address1,address2:e.data.address2,country:e.data.country,state:e.data.state,zip:e.data.postal_code},ITMCampaign:window.ITMCampaign,ITMContent:window.ITMContent}};return u.subscriptionDetails.isPaypal&&e.ui.addCompanyDetails&&(u.subscriptionDetails.billing_info={},e.data.company&&""!==e.data.company&&(u.subscriptionDetails.billing_info.company=e.data.company),e.data.vat_number&&""!==e.data.vat_number&&(u.subscriptionDetails.billing_info.vat_number=e.data.vat_number)),o.sendMB("subscription-form-submitted",{currencyCode:u.subscriptionDetails.currencyCode,plan_code:u.subscriptionDetails.plan_code,coupon_code:u.subscriptionDetails.coupon_code,isPaypal:u.subscriptionDetails.isPaypal}),o.send("subscription-funnel","subscription-form-submitted",u.subscriptionDetails.plan_code),t.post("/user/subscription/create",u).then((function(){o.sendMB("subscription-submission-success"),o.send("subscription-funnel","subscription-submission-success",u.subscriptionDetails.plan_code),window.location.href="/user/subscription/thank-you"})).catch((function(n){e.processing=!1;var t=n.data;e.genericError=t&&t.message||"Something went wrong processing the request",t.threeDSecureActionTokenId&&l(t.threeDSecureActionTokenId)}))}o.sendMB("subscription-error",n),o.send("subscription-funnel","subscription-error"),e.$evalAsync((function(){e.processing=!1,e.genericError=n.message,a.a.each(n.fields,(function(n){return e.validation.errorFields[n]=!0}))}))};e.submit=function(){if(e.processing=!0,"paypal"===e.paymentMethod.value){var n={description:e.planName};recurly.paypal(n,s)}else{var t=a.a.cloneDeep(e.data);e.ui.addCompanyDetails||(delete t.company,delete t.vat_number),recurly.token(t,s)}};var l=function(n){var t=recurly.Risk().ThreeDSecure({actionTokenId:n});t.on("error",(function(n){e.genericError="Error: ".concat(n.message),e.threeDSecureFlow=!1,e.$apply()})),t.on("token",(function(n){s(null,null,n),e.genericError=null,e.threeDSecureFlow=!1,e.processing=!0,e.$apply()})),e.threeDSecureRecurlyContainer.innerHTML="",e.threeDSecureFlow=!0,t.attach(e.threeDSecureRecurlyContainer),window.setTimeout((function(){e.threeDSecureContainer.scrollIntoView()}),0)};e.countries=[{code:"AF",name:"Afghanistan"},{code:"AX",name:"Åland Islands"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AC",name:"Ascension Island"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"BQ",name:"British Antarctic Territory"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"CV",name:"Cabo Verde"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"IC",name:"Canary Islands"},{code:"CT",name:"Canton and Enderbury Islands"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"EA",name:"Ceuta and Melilla"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CP",name:"Clipperton Island"},{code:"CC",name:"Cocos [Keeling] Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo - Brazzaville"},{code:"CD",name:"Congo - Kinshasa"},{code:"CD",name:"Congo [DRC]"},{code:"CG",name:"Congo [Republic]"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"CI",name:"Côte d’Ivoire"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"DK",name:"Denmark"},{code:"DG",name:"Diego Garcia"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"NQ",name:"Dronning Maud Land"},{code:"TL",name:"East Timor"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands [Islas Malvinas]"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"FQ",name:"French Southern and Antarctic Territories"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GW",name:"Guinea-Bissau"},{code:"GN",name:"Guinea"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard Island and McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"CI",name:"Ivory Coast"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JT",name:"Johnston Island"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macau SAR China"},{code:"MO",name:"Macau"},{code:"MK",name:"Macedonia [FYROM]"},{code:"MK",name:"Macedonia"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"FX",name:"Metropolitan France"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MI",name:"Midway Islands"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar [Burma]"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"AN",name:"Netherlands Antilles"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"VD",name:"North Vietnam"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"QO",name:"Outlying Oceania"},{code:"PC",name:"Pacific Islands Trust Territory"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PZ",name:"Panama Canal Zone"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"YD",name:"People's Democratic Republic of Yemen"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RE",name:"Réunion"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"BL",name:"Saint Barthélemy"},{code:"SH",name:"Saint Helena"},{code:"KN",name:"Saint Kitts and Nevis"},{code:"LC",name:"Saint Lucia"},{code:"MF",name:"Saint Martin"},{code:"PM",name:"Saint Pierre and Miquelon"},{code:"VC",name:"Saint Vincent and the Grenadines"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"São Tomé and Príncipe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"CS",name:"Serbia and Montenegro"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard and Jan Mayen"},{code:"SZ",name:"Swaziland"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad and Tobago"},{code:"TA",name:"Tristan da Cunha"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks and Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"UM",name:"U.S. Minor Outlying Islands"},{code:"PU",name:"U.S. Miscellaneous Pacific Islands"},{code:"VI",name:"U.S. Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WK",name:"Wake Island"},{code:"WF",name:"Wallis and Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"}]}else e.recurlyLoadError=!0}]),r.a.controller("AnnualUpgradeController",["$scope","$http","$modal",function(e,n,t){e.upgradeComplete=!1;var r={student:"19.2",collaborator:"36"};return e.$watch(e.planName,(function(){if(e.yearlySaving=r[e.planName],"annual"===e.planName)return e.upgradeComplete=!0})),e.completeAnnualUpgrade=function(){var t={planName:e.planName,_csrf:window.csrfToken};return e.inflight=!0,n.post("/user/subscription/upgrade-annual",t).then((function(){return e.upgradeComplete=!0})).catch((function(){return console.log("something went wrong changing plan")}))}}]),r.a.controller("RegisterUsersController",["$scope","queuedHttp",function(e,n){e.users=[],e.inputs={emails:""};return e.registerUsers=function(){var t=function(e){var n=e.split(/[\s,]+/);return n=a.a.map(n,(function(e){return e.trim()})),n=a.a.filter(n,(function(e){return-1!==e.indexOf("@")}))}(e.inputs.emails);return e.error=!1,Array.from(t).map((function(t){return n.post("/admin/register",{email:t,_csrf:window.csrfToken}).then((function(n){var t=n.data;return e.users.push(t),e.inputs.emails=""})).catch((function(){return e.error=!0}))}))}}]),r.a.controller("TeamInviteController",["$scope","$http",function(e,n){e.inflight=!1;var t=Object(p.a)("ol-hasIndividualRecurlySubscription");return e.view=t?"hasIndividualRecurlySubscription":"teamInvite",e.keepPersonalSubscription=function(){return e.view="teamInvite"},e.cancelPersonalSubscription=function(){e.inflight=!0;var t=n.post("/user/subscription/cancel",{_csrf:window.csrfToken});return t.then((function(){return e.inflight=!1,e.view="teamInvite"})),t.catch((function(){e.inflight=!1,e.cancel_error=!0,console.log("the request failed")}))},e.joinTeam=function(){e.inflight=!0;var t=Object(p.a)("ol-inviteToken"),r=n.put("/subscription/invites/".concat(t,"/"),{_csrf:window.csrfToken});return r.then((function(n){var t=n.status;if(e.inflight=!1,e.view="inviteAccepted",200!==t)return e.requestSent=!1})),r.catch((function(){return console.log("the request failed")}))}}]),r.a.controller("UpgradeSubscriptionController",["$scope","eventTracking",function(e,n){e.upgradeSubscription=function(){n.send("subscription-funnel","subscription-page","upgrade")}}]),r.a.directive("mathjax",["$compile","$parse",function(e,n){return{link:function(e,n,t){if(MathJax&&MathJax.Hub){if("no-single-dollar"!==t.delimiter){var r=MathJax.Hub.config&&MathJax.Hub.config.tex2jax.inlineMath;a.a.find(r,(function(e){return"$"===e[0]&&"$"===e[1]}))||MathJax.Hub.Config({tex2jax:{inlineMath:r.concat([["$","$"]])}})}setTimeout((function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub,n.get(0)])}),0)}}}}]),t(178);r.a.controller("SearchWikiController",["$scope","algoliaSearch","$modal",function(e,n,t){e.hits=[],e.hits_total=0,e.config_hits_per_page=20,e.processingSearch=!1,e.clearSearchText=function(){return e.searchQueryText="",o([])},e.safeApply=function(n){var t=e.$root.$$phase;return"$apply"===t||"$digest"===t?e.$eval(n):e.$apply(n)};var r=function(e){var n=e.kb?"how-to/":"latex/",t=encodeURIComponent(e.pageName.replace(/\s/g,"_")),r="";e.sectionName&&""!==e.sectionName&&(r="#"+e.sectionName.replace(/\s/g,"_"));var o=e._highlightResult.sectionName,a=e._highlightResult.pageName.value;o&&o.value&&""!==o&&(a+=" - "+o.value);for(var i=e._highlightResult.content.value,c=(i=i.replace(/\n\n+/g,"\n\n")).split("\n"),s=[],l=0,u=Array.from(c);l<u.length;l++){var d=u[l];/^\[edit\]/.test(d)||(i+=d+"\n",/<em>/.test(d)&&s.push(d))}return i=s.join("\n...\n"),{name:a,url:"/learn/".concat(n).concat(t).concat(r),content:i}},o=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.safeApply((function(){e.hits=n,e.hits_total=t}))};e.search=function(){e.processingSearch=!0;var t=e.searchQueryText;if(null!=t&&0!==t.length)return n.searchWiki(t,{hitsPerPage:e.config_hits_per_page},(function(n,t){if(e.processingSearch=!1,0===t.hits.length)return o([]);var i=a.a.map(t.hits,r);return o(i,t.nbHits)}));o([])}}]);r.a.controller("LearnController",(function(){})),t(248);var g=function(e,n,t,r){var o=this;o.roles=[],o.departments=[],o.countries=[],o.universities=[];var i=[];o.addUniversityToSelection=function(e){return{name:e,isUserSuggested:!0}},o.handleFreeformInputChange=function(e,n){if(null!=e.search&&""!==e.search){var t=e.search;if(null!=(null!=e.tagging?e.tagging.fct:void 0)&&(t=e.tagging.fct(e.search)),null!=n){var r=a.a.find(e.items,(function(t){return t[n]===e.search}));null!=r&&(t=r)}return e.searchInput.scope().$broadcast("uis:select",t)}},r.getCountries().then((function(e){return o.countries=e})),r.getDefaultRoleHints().then((function(e){return o.roles=e})),r.getDefaultDepartmentHints().then((function(e){return i=e})),e.$watch("$ctrl.affiliationData.country",(function(e,n){if(null!=e&&e!==n)return o.affiliationData.university=null,o.affiliationData.role=null,o.affiliationData.department=null,r.getUniversitiesFromCountry(e).then((function(e){return o.universities=e}))})),e.$watch("$ctrl.affiliationData.university",(function(e,n){return null!=e&&e!==n&&(null!=e.departments?e.departments.length:void 0)>0?o.departments=a.a.uniq(e.departments):o.departments=i}))};g.$inject=["$scope","$element","$attrs","UserAffiliationsDataService"];r.a.component("affiliationForm",{bindings:{affiliationData:"=",showUniversityAndCountry:"<",showRoleAndDepartment:"<"},controller:g,templateUrl:"affiliationFormTpl"});var v=function(e,n,t,r){var o=this;o.showHint=!1,o.hasFocus=!1,o.handleFocus=function(){return o.hasFocus=!0,o.suggestion=null},o.handleBlur=function(){return o.showHint=!1,o.hasFocus=!1,o.suggestion=null,o.onBlur()},o.handleKeyDown=function(e){return e.which!==r.TAB&&e.which!==r.ENTER||null==o.suggestion||""===o.suggestion||(e.preventDefault(),o.localNgModel+=o.suggestion),o.suggestion=null,o.showHint=!1},e.$watch("$ctrl.localNgModel",(function(e,n){if(o.hasFocus&&e!==n)return o.suggestion=null,o.showHint=!1,o.getSuggestion({userInput:e}).then((function(n){if(null!=n&&e===o.localNgModel)return o.showHint=!0,o.suggestion=n.replace(e,"")})).catch((function(){return o.suggestion=null}))}))};v.$inject=["$scope","$element","$attrs","Keys"];r.a.component("inputSuggestions",{bindings:{localNgModel:"=ngModel",localNgModelOptions:"=?ngModelOptions",getSuggestion:"&",onBlur:"&?",inputId:"@?",inputName:"@?",inputPlaceholder:"@?",inputType:"@?",inputRequired:"=?"},controller:v,template:['<div class="input-suggestions">','<div class="form-control input-suggestions-shadow">','<span ng-bind="$ctrl.localNgModel"',' class="input-suggestions-shadow-existing"',' ng-show="$ctrl.showHint">',"</span>",'<span ng-bind="$ctrl.suggestion"',' class="input-suggestions-shadow-suggested"',' ng-show="$ctrl.showHint">',"</span>","</div>",'<input type="text"',' class="form-control input-suggestions-main"',' ng-focus="$ctrl.handleFocus()"',' ng-keyDown="$ctrl.handleKeyDown($event)"',' ng-blur="$ctrl.handleBlur()"',' ng-model="$ctrl.localNgModel"',' ng-model-options="$ctrl.localNgModelOptions"',' ng-model-options="{ debounce: 50 }"',' ng-attr-id="{{ ::$ctrl.inputId }}"',' ng-attr-placeholder="{{ ::$ctrl.inputPlaceholder }}"',' ng-attr-type="{{ ::$ctrl.inputType }}"',' ng-attr-name="{{ ::$ctrl.inputName }}"',' ng-required="::$ctrl.inputRequired">',"</div>"].join("")}),t(31),t(27);function w(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return y(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return y(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}r.a.controller("UserAffiliationsController",["$scope","$rootScope","UserAffiliationsDataService","$q","$window",function(e,n,t,r,o){e.userEmails=[],e.linkedInstitutionIds=[],e.hideInstitutionNotifications={},e.closeInstitutionNotification=function(n){e.hideInstitutionNotifications[n]=!0},e.samlBetaSession=ExposedSettings.hasSamlBeta,e.samlInitPath=ExposedSettings.samlInitPath,e.reconfirmationRemoveEmail=Object(p.a)("ol-reconfirmationRemoveEmail"),e.reconfirmedViaSAML=Object(p.a)("ol-reconfirmedViaSAML");var i=/([^@]+)@(.+)/,c=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\ ".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA -Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,s=function(e){var n=e?e.match(i):void 0;return n?{local:n[1],domain:n[2]}:{local:null,domain:null}},l=function(n){return!!ExposedSettings.hasSamlFeature&&(!!n&&(!!n.ssoEnabled||!(!e.samlBetaSession||!n.ssoBeta)))};e.getEmailSuggestion=function(n){var o=s(n);return e.ui.isValidEmail=c.test(n),e.ui.isBlacklistedEmail=!1,e.ui.showManualUniversitySelectionUI=!1,o.domain?(e.ui.isBlacklistedEmail=t.isDomainBlacklisted(o.domain),t.getUniversityDomainFromPartialDomainInput(o.domain).then((function(n){return s(e.newAffiliation.email).domain===n.hostname?(e.newAffiliation.university=n.university,e.newAffiliation.department=n.department,e.newAffiliation.ssoAvailable=function(e){if(!e)return!1;if(!e.confirmed)return!1;var n=e.university;return!!l(n)}(n)):m(),r.resolve("".concat(o.local,"@").concat(n.hostname))})).catch((function(){return m(),r.reject(null)}))):(m(),r.reject(null))},e.linkInstitutionAcct=function(n,t){h(),e.ui.isMakingRequest=!0,e.ui.isProcessing=!0,o.location.href="".concat(e.samlInitPath,"?university_id=").concat(t,"&auto=/user/settings&email=").concat(n)},e.selectUniversityManually=function(){m(),e.ui.showManualUniversitySelectionUI=!0},e.changeAffiliation=function(n){a.a.get(n,["affiliation","institution","id"])&&t.getUniversityDetails(n.affiliation.institution.id).then((function(n){return e.affiliationToChange.university=n})),e.affiliationToChange.email=n.email,e.affiliationToChange.role=n.affiliation.role,e.affiliationToChange.department=n.affiliation.department},e.saveAffiliationChange=function(n){return n.affiliation.role=e.affiliationToChange.role,n.affiliation.department=e.affiliationToChange.department,u(),v(t.addRoleAndDepartment(n.email,n.affiliation.role,n.affiliation.department)).then((function(){return setTimeout((function(){return y()}))}))},e.cancelAffiliationChange=function(e){return u()},e.isChangingAffiliation=function(n){return e.affiliationToChange.email===n},e.showAddEmailForm=function(){return e.ui.showAddEmailUI=!0},e.addNewEmail=function(){var n;return n=e.newAffiliation.university?e.newAffiliation.university.isUserSuggested?t.addUserAffiliationWithUnknownUniversity(e.newAffiliation.email,e.newAffiliation.university.name,e.newAffiliation.country.code,e.newAffiliation.role,e.newAffiliation.department):t.addUserAffiliation(e.newAffiliation.email,e.newAffiliation.university.id,e.newAffiliation.role,e.newAffiliation.department):t.addUserEmail(e.newAffiliation.email),e.ui.isAddingNewEmail=!0,e.ui.showAddEmailUI=!1,v(n).then((function(){d(),f(),setTimeout((function(){return y()}))})).finally((function(){return e.ui.isAddingNewEmail=!1}))},e.setDefaultUserEmail=function(r){return v(t.setDefaultUserEmail(r.email)).then((function(){var t,o=w(e.userEmails||[]);try{for(o.s();!(t=o.n()).done;){t.value.default=!1}}catch(e){o.e(e)}finally{o.f()}r.default=!0,window.usersEmail=r.email,n.usersEmail=r.email}))},e.removeUserEmail=function(n){return e.userEmails=e.userEmails.filter((function(e){return e!==n})),v(t.removeUserEmail(n.email))},e.resendConfirmationEmail=function(n){return h(),e.ui.isResendingConfirmation=!0,v(t.resendConfirmationEmail(n.email)).finally((function(){return e.ui.isResendingConfirmation=!1}))},e.acknowledgeError=function(){return g(),y()};var u=function(){return e.affiliationToChange={email:"",university:null,role:null,department:null}},d=function(){return e.newAffiliation={email:"",country:null,university:null,role:null,department:null}},f=function(){e.ui.showAddEmailUI=!1,e.ui.isValidEmail=!1,e.ui.isBlacklistedEmail=!1,e.ui.showManualUniversitySelectionUI=!1},m=function(){e.newAffiliation={email:e.newAffiliation.email}},h=function(){e.ui.isLoadingEmails=!1,e.ui.isProcessing=!1,e.ui.isResendingConfirmation=!1},g=function(){return e.ui={hasError:!1,errorMessage:"",showChangeAffiliationUI:!1,isMakingRequest:!1,isLoadingEmails:!1,isAddingNewEmail:!1},u(),d(),f()};g();var v=function(n){return e.ui.hasError=!1,e.ui.isMakingRequest=!0,n.catch((function(n){e.ui.hasError=!0,e.ui.errorMessage=a.a.get(n,["data","message"])})).finally((function(){return e.ui.isMakingRequest=!1})),n};e.inReconfirmNotificationPeriod=function(e){return a.a.get(e,["affiliation","inReconfirmNotificationPeriod"])},e.institutionAlreadyLinked=function(n){var t=n.affiliation&&n.affiliation.institution&&n.affiliation.institution&&n.affiliation.institution.id?n.affiliation.institution.id.toString():void 0;return-1!==e.linkedInstitutionIds.indexOf(t)};var y=function(){h(),e.ui.isLoadingEmails=!0,v(t.getUserEmailsEnsureAffiliation()).then((function(n){e.userEmails=n.map((function(e){return e.ssoAvailable=function(e){if(!e)return!1;var n=e.institution;return!!l(n)&&!!n.confirmed}(e.affiliation),e})),e.linkedInstitutionIds=n.filter((function(e){if(e.samlProviderId)return e.samlProviderId})).map((function(e){return e.samlProviderId}))})).finally((function(){return e.ui.isLoadingEmails=!1}))};y()}]);function b(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return S(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(c)throw a}}}}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}for(var C=[{code:"af",name:"Afghanistan"},{code:"ax",name:"Åland Islands"},{code:"al",name:"Albania"},{code:"dz",name:"Algeria"},{code:"as",name:"American Samoa"},{code:"ad",name:"Andorra"},{code:"ao",name:"Angola"},{code:"ai",name:"Anguilla"},{code:"aq",name:"Antarctica"},{code:"ag",name:"Antigua and Barbuda"},{code:"ar",name:"Argentina"},{code:"am",name:"Armenia"},{code:"aw",name:"Aruba"},{code:"au",name:"Australia"},{code:"at",name:"Austria"},{code:"az",name:"Azerbaijan"},{code:"bs",name:"Bahamas"},{code:"bh",name:"Bahrain"},{code:"bd",name:"Bangladesh"},{code:"bb",name:"Barbados"},{code:"by",name:"Belarus"},{code:"be",name:"Belgium"},{code:"bz",name:"Belize"},{code:"bj",name:"Benin"},{code:"bm",name:"Bermuda"},{code:"bt",name:"Bhutan"},{code:"bo",name:"Bolivia"},{code:"bq",name:"Bonaire, Saint Eustatius and Saba"},{code:"ba",name:"Bosnia and Herzegovina"},{code:"bw",name:"Botswana"},{code:"bv",name:"Bouvet Island"},{code:"br",name:"Brazil"},{code:"io",name:"British Indian Ocean Territory"},{code:"vg",name:"British Virgin Islands"},{code:"bn",name:"Brunei"},{code:"bg",name:"Bulgaria"},{code:"bf",name:"Burkina Faso"},{code:"bi",name:"Burundi"},{code:"kh",name:"Cambodia"},{code:"cm",name:"Cameroon"},{code:"ca",name:"Canada"},{code:"cv",name:"Cabo Verde"},{code:"ky",name:"Cayman Islands"},{code:"cf",name:"Central African Republic"},{code:"td",name:"Chad"},{code:"cl",name:"Chile"},{code:"cn",name:"China"},{code:"cx",name:"Christmas Island"},{code:"cc",name:"Cocos (Keeling) Islands"},{code:"co",name:"Colombia"},{code:"km",name:"Comoros"},{code:"cg",name:"Congo"},{code:"ck",name:"Cook Islands"},{code:"cr",name:"Costa Rica"},{code:"ci",name:"Côte d'Ivoire"},{code:"hr",name:"Croatia"},{code:"cu",name:"Cuba"},{code:"cw",name:"Curaçao"},{code:"cy",name:"Cyprus"},{code:"cz",name:"Czech Republic"},{code:"kp",name:"Democratic People's Republic of Korea"},{code:"cd",name:"Democratic Republic of the Congo"},{code:"dk",name:"Denmark"},{code:"dj",name:"Djibouti"},{code:"dm",name:"Dominica"},{code:"do",name:"Dominican Republic"},{code:"ec",name:"Ecuador"},{code:"eg",name:"Egypt"},{code:"sv",name:"El Salvador"},{code:"gq",name:"Equatorial Guinea"},{code:"er",name:"Eritrea"},{code:"ee",name:"Estonia"},{code:"et",name:"Ethiopia"},{code:"fk",name:"Falkland Islands (Malvinas)"},{code:"fo",name:"Faroe Islands"},{code:"fj",name:"Fiji"},{code:"fi",name:"Finland"},{code:"fr",name:"France"},{code:"gf",name:"French Guiana"},{code:"pf",name:"French Polynesia"},{code:"tf",name:"French Southern Territories"},{code:"ga",name:"Gabon"},{code:"gm",name:"Gambia"},{code:"ge",name:"Georgia"},{code:"de",name:"Germany"},{code:"gh",name:"Ghana"},{code:"gi",name:"Gibraltar"},{code:"gr",name:"Greece"},{code:"gl",name:"Greenland"},{code:"gd",name:"Grenada"},{code:"gp",name:"Guadeloupe"},{code:"gu",name:"Guam"},{code:"gt",name:"Guatemala"},{code:"gg",name:"Guernsey"},{code:"gn",name:"Guinea"},{code:"gw",name:"Guinea-Bissau"},{code:"gy",name:"Guyana"},{code:"ht",name:"Haiti"},{code:"hm",name:"Heard Island and McDonald Islands"},{code:"va",name:"Holy See (Vatican City)"},{code:"hn",name:"Honduras"},{code:"hk",name:"Hong Kong"},{code:"hu",name:"Hungary"},{code:"is",name:"Iceland"},{code:"in",name:"India"},{code:"id",name:"Indonesia"},{code:"ir",name:"Iran"},{code:"iq",name:"Iraq"},{code:"ie",name:"Ireland"},{code:"im",name:"Isle of Man"},{code:"il",name:"Israel"},{code:"it",name:"Italy"},{code:"jm",name:"Jamaica"},{code:"jp",name:"Japan"},{code:"je",name:"Jersey"},{code:"jo",name:"Jordan"},{code:"kz",name:"Kazakhstan"},{code:"ke",name:"Kenya"},{code:"ki",name:"Kiribati"},{code:"xk",name:"Kosovo"},{code:"kw",name:"Kuwait"},{code:"kg",name:"Kyrgyzstan"},{code:"la",name:"Laos"},{code:"lv",name:"Latvia"},{code:"lb",name:"Lebanon"},{code:"ls",name:"Lesotho"},{code:"lr",name:"Liberia"},{code:"ly",name:"Libya"},{code:"li",name:"Liechtenstein"},{code:"lt",name:"Lithuania"},{code:"lu",name:"Luxembourg"},{code:"mo",name:"Macao"},{code:"mk",name:"Macedonia"},{code:"mg",name:"Madagascar"},{code:"mw",name:"Malawi"},{code:"my",name:"Malaysia"},{code:"mv",name:"Maldives"},{code:"ml",name:"Mali"},{code:"mt",name:"Malta"},{code:"mh",name:"Marshall Islands"},{code:"mq",name:"Martinique"},{code:"mr",name:"Mauritania"},{code:"mu",name:"Mauritius"},{code:"yt",name:"Mayotte"},{code:"mx",name:"Mexico"},{code:"fm",name:"Micronesia"},{code:"md",name:"Moldova"},{code:"mc",name:"Monaco"},{code:"mn",name:"Mongolia"},{code:"me",name:"Montenegro"},{code:"ms",name:"Montserrat"},{code:"ma",name:"Morocco"},{code:"mz",name:"Mozambique"},{code:"mm",name:"Myanmar"},{code:"na",name:"Namibia"},{code:"nr",name:"Nauru"},{code:"np",name:"Nepal"},{code:"nl",name:"Netherlands"},{code:"an",name:"Netherlands Antilles"},{code:"nc",name:"New Caledonia"},{code:"nz",name:"New Zealand"},{code:"ni",name:"Nicaragua"},{code:"ne",name:"Niger"},{code:"ng",name:"Nigeria"},{code:"nu",name:"Niue"},{code:"nf",name:"Norfolk Island"},{code:"mp",name:"Northern Mariana Islands"},{code:"no",name:"Norway"},{code:"om",name:"Oman"},{code:"pk",name:"Pakistan"},{code:"pw",name:"Palau"},{code:"ps",name:"Palestine"},{code:"pa",name:"Panama"},{code:"pg",name:"Papua New Guinea"},{code:"py",name:"Paraguay"},{code:"pe",name:"Peru"},{code:"ph",name:"Philippines"},{code:"pn",name:"Pitcairn"},{code:"pl",name:"Poland"},{code:"pt",name:"Portugal"},{code:"pr",name:"Puerto Rico"},{code:"qa",name:"Qatar"},{code:"kr",name:"Republic of Korea"},{code:"re",name:"Réunion"},{code:"ro",name:"Romania"},{code:"ru",name:"Russia"},{code:"rw",name:"Rwanda"},{code:"bl",name:"Saint Barthélemy"},{code:"sh",name:"Saint Helena, Ascension and Tristan da Cunha"},{code:"kn",name:"Saint Kitts and Nevis"},{code:"lc",name:"Saint Lucia"},{code:"mf",name:"Saint Martin"},{code:"pm",name:"Saint Pierre and Miquelon"},{code:"vc",name:"Saint Vincent and the Grenadines"},{code:"ws",name:"Samoa"},{code:"sm",name:"San Marino"},{code:"st",name:"Sao Tome and Principe"},{code:"sa",name:"Saudi Arabia"},{code:"sn",name:"Senegal"},{code:"rs",name:"Serbia"},{code:"sc",name:"Seychelles"},{code:"sl",name:"Sierra Leone"},{code:"sg",name:"Singapore"},{code:"sx",name:"Sint Maarten"},{code:"sk",name:"Slovakia"},{code:"si",name:"Slovenia"},{code:"sb",name:"Solomon Islands"},{code:"so",name:"Somalia"},{code:"za",name:"South Africa"},{code:"gs",name:"South Georgia and the South Sandwich Islands"},{code:"ss",name:"South Sudan"},{code:"es",name:"Spain"},{code:"lk",name:"Sri Lanka"},{code:"sd",name:"Sudan"},{code:"sr",name:"Suriname"},{code:"sj",name:"Svalbard and Jan Mayen"},{code:"sz",name:"Swaziland"},{code:"se",name:"Sweden"},{code:"ch",name:"Switzerland"},{code:"sy",name:"Syria"},{code:"tw",name:"Taiwan"},{code:"tj",name:"Tajikistan"},{code:"tz",name:"Tanzania"},{code:"th",name:"Thailand"},{code:"tl",name:"Timor-Leste"},{code:"tg",name:"Togo"},{code:"tk",name:"Tokelau"},{code:"to",name:"Tonga"},{code:"tt",name:"Trinidad and Tobago"},{code:"tn",name:"Tunisia"},{code:"tr",name:"Turkey"},{code:"tm",name:"Turkmenistan"},{code:"tc",name:"Turks and Caicos Islands"},{code:"tv",name:"Tuvalu"},{code:"vi",name:"U.S. Virgin Islands"},{code:"ug",name:"Uganda"},{code:"ua",name:"Ukraine"},{code:"ae",name:"United Arab Emirates"},{code:"gb",name:"United Kingdom"},{code:"us",name:"United States of America"},{code:"um",name:"United States Minor Outlying Islands"},{code:"uy",name:"Uruguay"},{code:"uz",name:"Uzbekistan"},{code:"vu",name:"Vanuatu"},{code:"ve",name:"Venezuela"},{code:"vn",name:"Vietnam"},{code:"wf",name:"Wallis and Futuna"},{code:"eh",name:"Western Sahara"},{code:"ye",name:"Yemen"},{code:"zm",name:"Zambia"},{code:"zw",name:"Zimbabwe"}],T={},P={},E=["Undergraduate Student","Masters Student (MSc, MA, ...)","Doctoral Student (PhD, EngD, ...)","Postdoc","Lecturer","Senior Lecturer","Reader","Associate Professor ","Assistant Professor ","Professor","Emeritus Professor"],M=["Aeronautics & Astronautics","Anesthesia","Anthropology","Applied Physics","Art & Art History","Biochemistry","Bioengineering","Biology","Business School Library","Business, Graduate School of","Cardiothoracic Surgery","Chemical and Systems Biology","Chemical Engineering","Chemistry","Civil & Environmental Engineering","Classics","Communication","Comparative Literature","Comparative Medicine","Computer Science","Dermatology","Developmental Biology","Earth System Science","East Asian Languages and Cultures","Economics","Education, School of","Electrical Engineering","Energy Resources Engineering","English","French and Italian","Genetics","Geological Sciences","Geophysics","German Studies","Health Research & Policy","History","Iberian & Latin American Cultures","Law Library","Law School","Linguistics","Management Science & Engineering","Materials Science & Engineering","Mathematics","Mechanical Engineering","Medical Library","Medicine","Microbiology & Immunology","Molecular & Cellular Physiology","Music","Neurobiology","Neurology & Neurological Sciences","Neurosurgery","Obstetrics and Gynecology","Ophthalmology","Orthopaedic Surgery","Otolaryngology (Head and Neck Surgery)","Pathology","Pediatrics","Philosophy","Physics","Political Science","Psychiatry and Behavioral Sciences","Psychology","Radiation Oncology","Radiology","Religious Studies","Slavic Languages and Literature","Sociology","University Libraries","Statistics","Structural Biology","Surgery","Theater and Performance Studies","Urology"],j={"overleaf.com":!0},A=["br","cn","co","co.jp","co.uk","com","com.au","de","fr","in","info","io","net","no","ru","se","us","com.tw","com.br","pl","it","co.in","com.mx"],k=0,I=["gmail","googlemail","icloud","me","yahoo","ymail","yahoomail","hotmail","live","msn","outlook","gmx","mail","aol","163","mac","qq","o2","libero","126","protonmail","yandex","yeah","web","foxmail"];k<I.length;k++){var _,U=I[k],D=b(A);try{for(D.s();!(_=D.n()).done;){var R=_.value;j["".concat(U,".").concat(R)]=!0}}catch(e){D.e(e)}finally{D.f()}}r.a.factory("UserAffiliationsDataService",["$http","$q",function(e,n){var t=function(){return e.get("/user/emails").then((function(e){return e.data}))},r=function(e){return e.toLowerCase()in j};return{getCountries:function(){return n.resolve(C)},getDefaultRoleHints:function(){return n.resolve(E)},getDefaultDepartmentHints:function(){return n.resolve(M)},getUserEmails:t,getUserEmailsEnsureAffiliation:function(){return e.get("/user/emails?ensureAffiliation=true").then((function(e){return e.data}))},getUserDefaultEmail:function(){return t().then((function(e){return a.a.find(e,(function(e){return e.default}))}))},getUniversitiesFromCountry:function(t){var r;return r=null!=T[t.code]?T[t.code]:e.get("/institutions/list",{params:{country_code:t.code}}).then((function(e){return T[t.code]=e.data})),n.resolve(r)},getUniversityDomainFromPartialDomainInput:function(t){return null!=P[t]?n.resolve(P[t]):e.get("/institutions/domains",{params:{hostname:t,limit:1}}).then((function(e){var t=e.data[0];return null==t||r(t.hostname)?n.reject(null):(P[t.hostname]=t,n.resolve(t))}))},getUniversityDetails:function(n){return e.get("/institutions/list/".concat(n)).then((function(e){return e.data}))},addUserEmail:function(n){return e.post("/user/emails",{email:n,_csrf:window.csrfToken})},addUserAffiliationWithUnknownUniversity:function(n,t,r,o,a){return e.post("/user/emails",{email:n,university:{name:t,country_code:r},role:o,department:a,_csrf:window.csrfToken})},addUserAffiliation:function(n,t,r,o){return e.post("/user/emails",{email:n,university:{id:t},role:r,department:o,_csrf:window.csrfToken})},addRoleAndDepartment:function(n,t,r){return e.post("/user/emails/endorse",{email:n,role:t,department:r,_csrf:window.csrfToken})},setDefaultUserEmail:function(n){return e.post("/user/emails/default",{email:n,_csrf:window.csrfToken})},removeUserEmail:function(n){return e.post("/user/emails/delete",{email:n,_csrf:window.csrfToken})},resendConfirmationEmail:function(n){return e.post("/user/emails/resend_confirmation",{email:n,_csrf:window.csrfToken})},isDomainBlacklisted:r}}]);r.a.controller("UserAffiliationsReconfirmController",["$scope","$http","$window",function(e,n,t){var r=ExposedSettings.samlInitPath;e.reconfirm={},e.ui=e.ui||{},e.userEmails=Object(p.a)("ol-userEmails"),e.reconfirmedViaSAML=Object(p.a)("ol-reconfirmedViaSAML");var o=Object(p.a)("ol-portalAffiliation");o&&(e.portalInReconfirmNotificationPeriod=o&&o.inReconfirmNotificationPeriod,e.userEmail=e.portalInReconfirmNotificationPeriod),e.reconfirmationRemoveEmail=Object(p.a)("ol-reconfirmationRemoveEmail"),e.allInReconfirmNotificationPeriods=Object(p.a)("ol-allInReconfirmNotificationPeriods"),e.requestReconfirmation=function(o,i){var c=i.email;e.ui.isMakingRequest=!0,e.ui.isProcessing=!0,e.reconfirm[c]=e.reconfirm[c]||{};var s=o.currentTarget.getAttribute("data-location"),l=a.a.get(i,["affiliation","institution","id"]);a.a.get(i,["affiliation","institution","ssoEnabled"])?t.location.href="".concat(r,"?university_id=").concat(l,"&reconfirm=").concat(s):function(t){e.ui.hasError=!1,e.ui.isMakingRequest=!0,n.post("/user/emails/send-reconfirmation",{email:t,_csrf:window.csrfToken}).then((function(){e.reconfirm[t].reconfirmationSent=!0})).catch((function(n){e.ui.hasError=!0})).finally((function(){return e.ui.isMakingRequest=!1}))}(c)}}]),r.a.controller("UserOauthController",["$http","$scope","$q",function(e,n,t){var r=function _unlinkError(e,t){n.providers[e].ui.hasError=!0,n.providers[e].ui.errorMessage=t&&t.data&&t.data.message?t.data.message:"error"};n.unlink=function(t){if(window.ExposedSettings.isOverleaf){n.providers[t].ui={hasError:!1,isProcessing:!0};var o={_csrf:window.csrfToken,link:!1,providerId:t};e.post("/user/oauth-unlink",o).catch((function(e){n.providers[t].ui.isProcessing=!1,r(t,e)})).then((function(e){n.providers[t].ui.isProcessing=!1,200===e.status?n.thirdPartyIds[t]=null:r(t,e)}))}},n.ui={hasError:!1,errorMessage:""},n.providers=window.oauthProviders,n.thirdPartyIds=window.thirdPartyIds}]),r.a.constant("Keys",{ENTER:13,TAB:9,ESCAPE:27,SPACE:32,BACKSPACE:8,UP:38,DOWN:40,LEFT:37,RIGHT:39,PERIOD:190,COMMA:188,END:35});r.a.controller("ImportingController",["$interval","$scope","$timeout","$window",function(e,n,t,r){e((function(){n.state.load_progress+=5,n.state.load_progress>100&&(n.state.load_progress=20)}),500),t((function(){r.location.reload()}),5e3),n.state={load_progress:20}}]),r.a.directive("autoSubmitForm",(function(){return{link:function(e,n){n.submit()}}}));t(19),t(21),t(249),t(173);function x(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(t.push(i.value),!n||t.length!==n);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return t}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return N(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return N(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}r.a.directive("asyncForm",["$http","validateCaptcha","validateCaptchaV3",function(e,n,t){return{controller:["$scope","$location",function(e,n){return this.getEmail=function(){return e.email},this.getEmailFromQuery=function(){return n.search().email||n.search().new_email},this}],link:function(r,o,a,i){var c,s=a.asyncForm;r[a.name].response=c={},r[a.name].inflight=!1,r.email=r.email||r.usersEmail||i.getEmailFromQuery()||a.newEmail;var l=function(e){for(var n={},t=0,i=Array.from(o.serializeArray());t<i.length;t++){var l=i[t];n[l.name]=l.value}return e&&(n["g-recaptcha-response"]=e),Object.keys(c).forEach((function(e){return delete c[e]})),r[a.name].inflight=!0,d(o.attr("method"))(o.attr("action"),n,{disableAutoLoginRedirect:!0}).then((function(e){var n=e.data,t=e.headers;r[a.name].inflight=!1,c.success=!0,c.error=!1;var o=r[a.onSuccess];if(o)o(e);else{if(n.redir)return ga("send","event",s,"success"),window.location=n.redir;if(n.message)return c.message=n.message,"error"===n.message.type?(c.success=!1,c.error=!0,ga("send","event",s,"failure",n.message)):ga("send","event",s,"success");if(r.$eval(a.asyncFormDownloadResponse)){var i=new Blob([n],{type:t("Content-Type")});location.href=URL.createObjectURL(i)}}})).catch((function(e){var n=e.data,t=e.status;r[a.name].inflight=!1,c.success=!1,c.error=!0,c.status=t,c.data=n;var o,i=r[a.onError];i?i(e):(o=n.message&&n.message.text?n.message.text:n.message,c.message=400===t?{text:o||"Invalid Request. Please correct the data and try again.",type:"error"}:403===t?{text:o||"Session error. Please check you have cookies enabled. If the problem persists, try clearing your cache and cookies.",type:"error"}:429===t?{text:o||"Too many attempts. Please wait for a while and try again.",type:"error"}:{text:o||"Something went wrong talking to the server :(. Please try again.",type:"error"},ga("send","event",s,"failure",n.message))}))},u=function(){return e=function(e){return l(e)},a.captchaActionName&&t(a.captchaActionName),void(null!=a.captcha?n(e):e());var e},d=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"post",t={post:e.post,get:e.get};return t[n.toLowerCase()]};o.on("submit",(function(e){e.preventDefault(),u()})),a.autoSubmit&&u()}}}]),r.a.directive("formMessages",(function(){return{restrict:"E",template:"<div class=\"alert\" ng-class=\"{\n'alert-danger': form.response.message.type == 'error',\n'alert-success': form.response.message.type != 'error'\n}\" ng-show=\"!!form.response.message\" ng-bind-html=\"form.response.message.text\">\n</div>\n<div ng-transclude></div>",transclude:!0,scope:{form:"=for"}}})),r.a.directive("complexPassword",(function(){return{require:["^asyncForm","ngModel"],link:function(e,n,t,r){PassField.Config.blackList=[];var o={pattern:"",length:{min:6,max:72},allowEmpty:!1,allowAnyChars:!1,isMasked:!0,showToggle:!1,showGenerate:!1,showTip:!1,showWarn:!1,checkMode:PassField.CheckModes.STRICT,chars:{digits:"1234567890",letters:"abcdefghijklmnopqrstuvwxyz",letters_up:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",symbols:"@#$%^&*()-_=+[]{};:<>/?!£€.,"}},i=a.a.defaults(window.passwordStrengthOptions||{},o);1===i.length.min&&(i.acceptRate=0),i.length.max>72&&(i.length.max=72),i.length.max>0&&(i.length.max+=1);var c=new PassField.Field("passwordField",i),s=x(Array.from(r),2),l=s[0],u=s[1];u.$parsers.unshift((function(n){var t=c.validatePass(),r=l.getEmail()||window.usersEmail;if(t){if("string"==typeof r&&""!==r){var o=r.split("@")[0];-1===n.indexOf(r)&&-1===n.indexOf(o)||(t=!1,e.complexPasswordErrorMessage="Password can not contain email address")}}else e.complexPasswordErrorMessage=c.getPassValidationMessage();return null!=i.length.max&&n.length>=i.length.max&&(t=!1,e.complexPasswordErrorMessage="Maximum password length ".concat(i.length.max-1," exceeded")),null!=i.length.min&&n.length<i.length.min&&(t=!1,e.complexPasswordErrorMessage="Password too short, minimum ".concat(i.length.min)),u.$setValidity("complexPassword",t),n}))}}}));t(250),t(251),r.a.directive("equals",(function(){return{require:"ngModel",link:function(e,n,t,r){var o="#".concat(t.equals);return n.add(o).on("keyup",(function(){return e.$apply((function(){var e=n.val()===$(o).val();return r.$setValidity("areEqual",e)}))}))}}})),r.a.directive("eventTracking",["eventTracking",function(e){return{scope:{eventTracking:"@",eventSegmentation:"=?"},link:function(n,t,r){var o=r.eventTrackingGa||!1,i=r.eventTrackingMb||!1,c=r.eventTrackingSendOnce?"sendMBOnce":"sendMB",s=r.eventTrackingSendOnce?"sendGAOnce":"send",l=n.eventSegmentation||{};l.page=window.location.pathname;var u=function(t){if(i&&e[c](n.eventTracking,l),o&&e[s](r.eventTrackingGa,r.eventTrackingAction||n.eventTracking,r.eventTrackingLabel||""),t)return $(window).unbind("resize scroll")};if("load"===r.eventTrackingTrigger)return u();if("click"===r.eventTrackingTrigger)return t.on("click",(function(e){return u()}));if("hover"===r.eventTrackingTrigger){var d=null,f=500;return r.eventHoverAmt&&(f=parseInt(r.eventHoverAmt,10)),t.on("mouseenter",(function(){d=setTimeout((function(){return u()}),f)})).on("mouseleave",(function(){return clearTimeout(d)}))}"scroll"!==r.eventTrackingTrigger||e.eventInCache(n.eventTracking)||$(window).on("resize scroll",a.a.throttle((function(){(function(e){var n=e.offset().top,t=n+e.outerHeight(),r=$(window).scrollTop(),o=r+$(window).height();return t>r&&n<o})(t)&&u(!0)}),500))}}}]),t(252),t(253);r.a.directive("selectAllList",(function(){return{controller:["$scope",function(e){this.selectAll=function(){return e.$broadcast("select-all:select")},this.deselectAll=function(){return e.$broadcast("select-all:deselect")},this.clearSelectAllState=function(){return e.$broadcast("select-all:clear")}}],link:function(e,n,t){}}})),r.a.directive("selectAll",(function(){return{require:"^selectAllList",link:function(e,n,t,r){return e.$on("select-all:clear",(function(){return n.prop("checked",!1)})),n.change((function(){return n.is(":checked")?r.selectAll():r.deselectAll(),!0}))}}})),r.a.directive("selectIndividual",(function(){return{require:"^selectAllList",scope:{ngModel:"="},link:function(e,n,t,r){var o=!1;return e.$watch("ngModel",(function(e){if(null!=e&&!o)return r.clearSelectAllState()})),e.$on("select-all:select",(function(){if(!n.prop("disabled"))return o=!0,e.$apply((function(){return e.ngModel=!0})),o=!1})),e.$on("select-all:deselect",(function(){if(!n.prop("disabled"))return o=!0,e.$apply((function(){return e.ngModel=!1})),o=!1})),e.$on("select-all:row-clicked",(function(){if(!n.prop("disabled"))return o=!0,e.$apply((function(){if(e.ngModel=!e.ngModel,!e.ngModel)return r.clearSelectAllState()})),o=!1}))}}}));r.a.directive("selectRow",(function(){return{scope:!0,link:function(e,n,t){return n.on("click",(function(n){return e.$broadcast("select-all:row-clicked")}))}}})),r.a.directive("maxHeight",(function(){return{restrict:"A",link:function(e,n,t){return e.$watch(t.maxHeight,(function(e){if(null!=e)return n.css({"max-height":e})}))}}}));r.a.directive("bookmarkableTabset",["$location",function(e){return{restrict:"A",require:"tabset",link:function(n,t,r,o){var i=function(e){if(e&&""!==e){var n=a.a.find(o.tabs,(function(n){return n.bookmarkableTabId===e}));if(n)return n.select(),t.children()[0].scrollIntoView({behavior:"smooth"})}};n.$applyAsync((function(){var n=e.hash();i(n);var t=document.querySelectorAll(".link-to-tab"),r=function(e){var n=e.currentTarget.getAttribute("href").split("#").pop();i(n)};t&&Array.from(t).map((function(e){return e.addEventListener("click",r)}))}))}}}]),r.a.directive("bookmarkableTab",["$location",function(e){return{restrict:"A",require:"tab",link:function(n,t,r,o){var a=t.isolateScope(),i=r.bookmarkableTab;a&&i&&""!==i&&(a.bookmarkableTabId=i,a.$watch("active",(function(n,t){if(n&&!t&&e.hash()!==i)return e.hash(i)})))}}}]);t(254),t(255),t(256);r.a.controller("AdminUserListController",["$scope","$http","$timeout","$window","$modal","queuedHttp",function(e,n,t,r,o,a){e.users=window.data.users,e.pages=window.data.pages,e.allSelected=!1,e.selectedUsers=[],e.timer,e.pageSelected=1,e.searchError=null;var i=function(){var n=$(".user-list-card").offset().top,t=$("footer").outerHeight()+25,o=$("aside").height()-56,a=r.innerHeight-n-t;return a<o&&(a=Math.min(o,r.innerHeight-n-25)),e.userListHeight=a};t((function(){return i()}),0),angular.element(r).bind("resize",(function(){return i(),e.$apply()}));var c=function(){e.isLoading=!0,e.searchError=null,window.data._csrf=window.csrfToken,window.data.query=e.searchText,window.data.regexp=e.searchRegExp,window.data.secondaryEmailSearch=e.secondaryEmailSearch,window.data.page=e.pageSelected;var t=n.post("/admin/user/search",window.data);return t.then((function(n){var t=n.data;return e.users=t.users,e.pages=t.pages,e.deletedUserCount=t.deletedUserCount,e.updateVisibleUsers(),e.isLoading=!1})),t.catch((function(n){n.data&&n.data.message?e.searchError=n.data:e.searchError={message:"Something went wrong"},e.isLoading=!1}))};return e.clearSearchText=function(){return e.searchText="",e.$emit("search:clear"),c()},e.searchUsers=function(){return e.pageSelected=1,c()},e.changePage=function(n){return e.pageSelected=n,c()},e.updateSelectedUsers=function(){return e.selectedUsers=e.users.filter((function(e){return e.selected}))},e.updateVisibleUsers=function(){e.visibleUsers=[];for(var n=0,t=Array.from(e.users);n<t.length;n++){var r=t[n];e.visibleUsers.push(r)}return e.updatePages()},e.getSelectedUsers=function(){return e.selectedUsers},e.getFirstSelectedUser=function(){return e.selectedUsers[0]},e.updatePages=function(){if(e.pagesList=[],e.pages>1)return function(e,n,t){for(var r=[],o=e<n,a=t?o?n+1:n-1:n,i=e;o?i<a:i>a;o?i++:i--)r.push(i);return r}(1,Math.min(100,e.pages),!0).map((function(n){return e.pagesList.push(n)}))},e._removeUserFromList=function(n){var t=e.users.indexOf(n);if(t>-1)return e.users.splice(t,1)},e.openDeleteUsersModal=function(){return o.open({templateUrl:"deleteUsersModalTemplate",controller:"DeleteUsersModalController",resolve:{users:function(){return e.getSelectedUsers()}}}).result.then((function(){return e.DeleteSelectedUsers()}))},e.DeleteSelectedUsers=function(){for(var n=e.getSelectedUsers(),t=0,r=Array.from(n);t<r.length;t++){var o=r[t];e._removeUserFromList(o),a({method:"DELETE",url:"/admin/user/".concat(o._id),headers:{"X-CSRF-Token":window.csrfToken}})}return e.searchUsers()},e.openSetPasswordModal=function(){return o.open({templateUrl:"setPasswordModalTemplate",controller:"SetPasswordModalController",resolve:{user:function(){return e.getFirstSelectedUser()}}}).result.then((function(n){return e.SetUserPassword(n)}))},e.SetUserPassword=function(n){var t=e.getFirstSelectedUser();return a.post("/admin/user/".concat(t._id,"/setPassword"),{newPassword:n,_csrf:window.csrfToken})},e.updateVisibleUsers()}]),r.a.controller("UserListItemController",["$scope",function(e){return e.$watch("user.selected",(function(n){if(null!=n)return e.updateSelectedUsers()}))}]),r.a.controller("DeleteUsersModalController",["$scope","$modalInstance","$timeout","users",function(e,n,t,r){return e.users=r,e.delete=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]);r.a.controller("SetPasswordModalController",["$scope","$modalInstance","$timeout","user",function(e,n,t,r){return e.user=r,e.inputs={newPassword:""},e.setPassword=function(){return n.close(e.inputs.newPassword)},e.cancel=function(){return n.dismiss("cancel")}}]);t(24),t(98);r.a.controller("AdminUserController",["$scope","$timeout","$modal","queuedHttp",function(e,n,t,r){e.error=void 0,e.user=window.data.user,e.projects=window.data.projects,e.deletedProjects=window.data.deletedProjects,e.searchText={value:""},e.searchRegExp={value:!1},e.selectedProjects=[],e.predicate="lastUpdated",e.reverse=!0,e.allSelected=!1,e.enableBetaError=!1,e.emailForm={newEmail:null,isEditing:!1},e.user.primaryEmailData=e.user.emails.find((function(n){return n.email===e.user.email})),e.dismissError=function(){return e.error=void 0};for(var o=0,a=Array.from(e.projects);o<a.length;o++){var i=a[o];i.accessLevel="owner"}return e.clearSearchText=function(){return e.searchText.value="",e.updateVisibleProjects()},e.searchProjects=function(){return e.updateVisibleProjects()},e.updateSelectedProjects=function(){return e.selectedProjects=e.projects.filter((function(e){return e.selected}))},e.getSelectedProjects=function(){return e.selectedProjects},e.thirdPartyIdentifier=function(n){var t=e.user.thirdPartyIdentifiers;if(t)for(var r=0;r<t.length;r++)if(t[r].providerId===n)return t[r].externalUserId;return null},e.resetEmailFormOnCancel=function(){e.emailForm.isEditing=!1,e.emailForm.newEmail=null},e.emailFormOnSuccess=function(){location.reload()},e.archivedIsArray=function(e){return Array.isArray(e.archived)},e.openArchiveProjectsModal=function(){return t.open({templateUrl:"archiveTrashLeaveOrDeleteProjectsModalTemplate",controller:"ArchiveTrashLeaveOrDeleteProjectsModalController",resolve:{projects:function(){return e.getSelectedProjects()},action:function(){return"delete"}}}).result.then((function(){return e.archiveOrLeaveSelectedProjects()}))},e.archiveOrLeaveSelectedProjects=function(){for(var n=e.getSelectedProjects(),t=0,o=Array.from(n);t<o.length;t++)(i=o[t]).archived=!0,r({method:"DELETE",url:"/admin/project/".concat(i._id),headers:{"X-CSRF-Token":window.csrfToken}});return e.updateVisibleProjects()},e.changePredicate=function(n){return e.predicate===n&&(e.reverse=!e.reverse),e.predicate=n},e.getSortIconClass=function(n){return n===e.predicate&&e.reverse?"fa-caret-down":n!==e.predicate||e.reverse?"":"fa-caret-up"},e.openDeleteSecondaryEmailModal=function(n){return e.error=void 0,t.open({templateUrl:"deleteSecondaryEmailModalTemplate",controller:"DeleteSecondaryEmailModalController",resolve:{users:function(){return[{email:n}]}}}).result.then((function(){return r({method:"DELETE",url:"/admin/user/".concat(e.user._id,"/secondaryemail"),data:{emailToRemove:n},headers:{"Content-type":"application/json;charset=utf-8","X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/user/".concat(e.user._id)}),100)})).catch((function(n){console.error(n),e.error=!0}))}))},e.openUnlinkOlModal=function(){return t.open({templateUrl:"unlinkOlModalTemplate",controller:"UnlinkOlModalController",resolve:{users:function(){return[e.user]}}}).result.then((function(){return r({method:"DELETE",url:"/admin/user/".concat(e.user._id,"/overleaf"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/user/".concat(e.user._id)}),100)}))}))},e.openDeleteUserModal=function(){return t.open({templateUrl:"deleteUsersModalTemplate",controller:"DeleteUsersModalController",resolve:{users:function(){return[e.user]}}}).result.then((function(){return e.DeleteUser()}))},e.DeleteUser=function(){var n=e.user;return r({method:"DELETE",url:"/admin/user/".concat(n._id),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/user"}),100)}))},e.refreshFeatures=function(){var n=e.user;return e.refreshingFeatures=!0,r({method:"POST",url:"/admin/user/".concat(n._id,"/refresh_features"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return location.reload()}))},e.openSetDefaultUserEmailModal=function(n){return t.open({templateUrl:"setDefaultUserEmailModalTemplate",controller:"SetDefaultUserEmailController",resolve:{email:function(){return n.email},confirmedAt:function(){return n.confirmedAt}}}).result.then((function(){return e.setDefaultUserEmail(n.email)}))},e.setDefaultUserEmail=function(n){var t=e.user;return r({method:"POST",url:"/admin/user/".concat(t._id,"/default_email"),headers:{"X-CSRF-Token":window.csrfToken},data:{email:n}}).then((function(){return location.reload()}))},e.generatePasswordResetUrl=function(){var n=e.user;return r({method:"POST",url:"/admin/user/".concat(n._id,"/generate_password_reset_url"),headers:{"X-CSRF-Token":window.csrfToken},data:{email:n.email}}).then((function(n){e.resetLink=!0,200===n.status?document.getElementById("resetLink").innerHTML+=n.data.url:document.getElementById("resetLink").innerHTML+="Error generating reset url"}))},e.updateVisibleProjects=function(){return e.visibleProjects=[],function(){for(var n=[],t=0,r=Array.from(e.projects);t<r.length;t++){i=r[t];var o=!0;null!=e.searchText.value&&""!==e.searchText.value&&(i.name.toLowerCase().match(e.searchText.value.toLowerCase())||(o=!1)),o?n.push(e.visibleProjects.push(i)):n.push(i.selected=!1)}return n}()},e.updateVisibleProjects()}]),r.a.controller("AdminDeletedProjectListItemController",["$scope","$http",function(e,n){e.getDeletedProjectName=function(e){return e.project?e.project.name:null}}]),r.a.controller("AdminProjectListItemController",["$scope",function(e){return e.$watch("project.selected",(function(n){if(null!=n)return e.updateSelectedProjects()}))}]),r.a.controller("UnlinkOlModalController",["$scope","$modalInstance","$timeout","users",function(e,n,t,r){e.users=r,e.unlink=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("DeleteSecondaryEmailModalController",["$scope","$modalInstance","$timeout","users",function(e,n,t,r){e.users=r,e.delete=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("SetDefaultUserEmailController",["$scope","$modalInstance","$timeout","email","confirmedAt",function(e,n,t,r,o){e.email=r,e.confirmedAt=o,e.confirm=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("DeleteDictionaryWordModalController",["$scope","$modalInstance","user","word",function(e,n,t,r){e.word=r,e.user=t,e.confirm=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("UserDictionaryController",["$scope","$http","$modal",function(e,n,t){e.user=window.data.user,e.dictionary=window.data.dictionary||[],e.inflight=!1,e.deleteWord=function(r){t.open({templateUrl:"deleteDictionaryWordModalTemplate",controller:"DeleteDictionaryWordModalController",resolve:{word:function(){return r},user:function(){return e.user}}}).result.then((function(){e.inflight=!0,n({url:"/admin/user/".concat(e.user._id,"/spelling/delete"),method:"POST",data:{word:r},headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.inflight=!1;var n=e.dictionary.indexOf(r);e.dictionary.splice(n,1)})).catch((function(){return e.deleteError=!0}))}))},e.deleteDictionary=function(){t.open({templateUrl:"deleteDictionaryWordModalTemplate",controller:"DeleteDictionaryWordModalController",resolve:{word:function(){return"ALL WORDS"},user:function(){return e.user}}}).result.then((function(){e.inflight=!0,n({url:"/admin/user/".concat(e.user._id,"/spelling/delete"),method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.inflight=!1,e.dictionary=[]})).catch((function(){return e.deleteError=!0}))}))}}]),r.a.controller("NewFeaturesOverrideModalController",["$scope","$modalInstance",function(e,n){e.cancel=function(){return n.dismiss("cancel")},e.reload=function(){return location.reload()}}]),r.a.controller("FeaturesOverrideController",["$scope","$http","$modal",function(e,n,t){e.newFeaturesOverride=function(){t.open({templateUrl:"newFeaturesOverrideTemplate",controller:"NewFeaturesOverrideModalController",size:"lg"})},e.deleteFeaturesOverride=function(t){e.inflight=!0,n({url:"/admin/user/".concat(e.user._id,"/features_override/").concat(t),method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return location.reload()}))}}]),r.a.controller("UserAuditLogEntryController",["$scope",function(e){e.auditLog=e.user.auditLog,e.auditLog.forEach((function(e){e.operationReadable=e.operation.replace(/-/g," ").replace(/sso/g,"SSO"),e.operationReadable=e.operationReadable.charAt(0).toUpperCase()+e.operationReadable.slice(1)}))}]),r.a.controller("AdminSubscriptionController",["$scope","$http",function(e,n){e.subscription=window.data.subscription,e.createdAt=window.createdAt,e.preventDefault=function(e){e.preventDefault()},e.deleteSubscription=function(){e.deleteError=!1,n({url:"/admin/subscription/".concat(e.subscription._id),method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){window.location="/admin/deletedSubscription/".concat(e.subscription._id)})).catch((function(){return e.deleteError=!0}))},e.updateAdminFormManager={_visible:!1,data:{},open:function(){this.data.admin_id=e.subscription.admin_id,this._visible=!0},cancel:function(){this._visible=!1},onSuccess:function(){e.subscription.admin_id=this.data.admin_id,e.updateAdminForm.response.message={type:"success",text:"Subscription admin user updated"},this._visible=!1},isVisible:function(){return this._visible&&this.isEnabled()},isEnabled:function(){return e.subscription.customAccount}},e.onUpdateAdminSuccess=function(){e.updateAdminFormManager.onSuccess()}}]),r.a.controller("AdminCreateSubscriptionController",["$scope",function(e){e.subscription={customAccount:!0,groupPlan:!0,planCode:"professional",membersLimit:10,admin_id:window.data.admin_id},e.preventDefault=function(e){e.preventDefault()},e.onSuccess=function(e){var n=e.data.subscription,t="/admin/subscription/".concat(n._id);window.location=t}}]),r.a.controller("AdminDeletedSubscriptionController",["$scope","$http",function(e,n){e.subscription=window.data.subscription,e.deletedAt=window.deletedAt,e.createdAt=window.createdAt,e.restoreSubscription=function(){e.restoreError=null,n({url:"/admin/deletedSubscription/".concat(e.subscription._id,"/restore"),method:"POST",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){window.location="/admin/subscription/".concat(e.subscription._id)})).catch((function(n){e.restoreError={message:n.data.message||n.status}}))}}]),r.a.controller("AdminGraphController",["$scope","$timeout","$location","$modal",function(e,n,t,r){e.user=window.data.user;var o=t.absUrl();return e.level=o.substr(o.indexOf("level=")+6,1),e.config={graph:window.data.graph,container:"graph",type:"canvas",settings:{defaultNodeColor:"#ccc",edgeColor:"target",edgeLabelSize:"proportional",enableEdgeHovering:!0,edgeHoverColor:"edge",edgeHoverSizeRatio:3}},sigma.renderers.def=sigma.renderers.canvas,e.sGraph=new sigma(e.config),e.sGraph.startForceAtlas2({worker:!0,barnesHutOptimize:!1}),e.sGraph.refresh(),e.sGraph.bind("clickNode",(function(n){return e.selectedElement={name:n.data.node.label,id:n.data.node.id,type:"User",link:"/admin/user/".concat(n.data.node.id)},e.openGraphModal()})),e.sGraph.bind("clickEdge",(function(n){return e.selectedElement={name:n.data.edge.label,id:n.data.edge.projectId,type:"Project",link:"/admin/project/".concat(n.data.edge.projectId)},e.openGraphModal()})),n((function(){return e.sGraph.stopForceAtlas2()}),500),e.openGraphModal=function(){return r.open({templateUrl:"graphModalTemplate",controller:"GraphModalController",resolve:{element:function(){return e.selectedElement}}})}}]);r.a.controller("GraphModalController",["$scope","$modalInstance","element",function(e,n,t){return e.element=t,e.close=function(){return n.close()}}]);r.a.controller("AdminProjectController",["$scope","$timeout","$modal","$http","queuedHttp",function(e,n,t,r,o){var a=JSON.parse($("#admin-project-data").text()),i=a.project,c=a.deletedProject,s=a.docSnapshots,l=a.usersById;e.project=i,e.deletedProject=c,e.docSnapshots=s,e.usersById=l,e.editingBrandVariationId=!1,e.tagList=function(){return(e.project._ownerTags||[]).map((function(e){return e.name})).join(", ")},e.getRestoreEndpoint=function(e,n){return"/admin/project/".concat(e,"/doc_snapshot/").concat(n,"/restore")},e.openResyncModal=function(){t.open({templateUrl:"ResyncModalTemplate",controller:"ResyncModalController",resolve:{project:function(){return i}}}).result.then((function(){setTimeout((function(){return window.location.href="/admin/project/".concat(e.project._id)}),100)}))},e.openTransferOwnershipModal=function(){t.open({templateUrl:"TransferOwnershipModalTemplate",controller:"TransferOwnershipModalController",resolve:{project:function(){return i}}}).result.then((function(n){return o({method:"POST",url:"/project/".concat(e.project._id,"/transfer-ownership"),data:{user_id:n},headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){return setTimeout((function(){return window.location.href="/admin/project/".concat(e.project._id)}),100)}))}))},e.undeleteProject=function(n){e.error=null,r.post("/admin/project/"+n._id+"/undelete",{_csrf:window.csrfToken}).then((function(){window.location.href="/admin/project/"+n._id}),(function(n){console.log(n),e.error="Failed to undelete project: ".concat(n.statusText)}))},e.getDeletedProjectField=function(e,n){return e.project?e.project[n]||"-":"scrubbed"},e.openCloneProjectModal=function(){t.open({templateUrl:"CloneProjectModalTemplate",controller:"AdminCloneProjectModalController",resolve:{project:function(){return i}}})},e.openDeleteProjectModal=function(){t.open({templateUrl:"DeleteProjectModalTemplate",controller:"DeleteProjectModalController",resolve:{project:function(){return i}}}).result.then((function(){return e.deleteProject()}))},e.deleteProject=function(){var n=e.project;o({method:"DELETE",url:"/admin/project/".concat(n._id),headers:{"X-CSRF-Token":window.csrfToken}}),window.location.href="/admin/user/".concat(n.owner_ref)}}]),r.a.controller("AdminCloneProjectModalController",["$scope","$modalInstance","$timeout","$http","project",function(e,n,t,r,o){e.inputs={projectName:"Debug: ".concat(o.name," (").concat(o._id,")")},e.state={inflight:!1,error:!1},e.cloneProject=function(){e.state.inflight=!0,e.state.error=!1,r.post("/project/".concat(o._id,"/clone"),{_csrf:window.csrfToken,projectName:e.inputs.projectName}).then((function(e){var n=e.data;return window.location="/project/".concat(n.project_id)})).catch((function(n){var t=n.data,r=n.status;return e.state.inflight=!1,e.state.error=400!==r||{message:t}}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("DeleteProjectModalController",["$scope","$modalInstance","$timeout","project",function(e,n,t,r){return e.project=r,e.delete=function(){return n.close()},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("ResyncModalController",["$scope","$modalInstance","queuedHttp","project",function(e,n,t,r){return e.project=r,e.inflight=!1,e.state=null,e.confirm=function(){e.inflight=!0,t({method:"POST",url:"/admin/project/".concat(e.project._id,"/resync"),headers:{"X-CSRF-Token":window.csrfToken}}).then((function(){e.inflight=!1,e.state="success"})).catch((function(n){e.inflight=!1,e.state="error",e.error=n}))},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("TransferOwnershipModalController",["$scope","$modalInstance","$http","project",function(e,n,t,r){var o=/^[a-f\d]{24}$/i,a=/([^@]+)@(.+)/;return e.project=r,e.user_id="",e.inflight=!1,e.user={},e.findUser=function(){e.inflight=!0,t.get("/admin/user/info/"+encodeURIComponent(e.user_id)).then((function(n){e.inflight=!1,n.data.user?(e.user=n.data.user,e.user._id===e.project.owner_ref?e.state="self-transfer":e.state="success"):e.state="error"}),(function(n){e.inflight=!1,404===n.status||422===n.status?e.state="notfound":e.state="error"}))},e.validUserId=function(){return e.user_id.match(o)||e.user_id.match(a)},e.confirm=function(){return n.close(e.user._id)},e.cancel=function(){return n.dismiss("cancel")}}]),r.a.controller("AuditLogEntryController",["$scope",function(e){var n=e.entry,t=e.usersById;e.initiator=t[n.initiatorId],e.previousOwner=t[n.info.previousOwnerId],e.newOwner=t[n.info.newOwnerId]}]),r.a.controller("DropboxRegistrationController",["$scope","$window","$http","$timeout",function(e,n,t,r){var o=window.location.hash.indexOf("access_token"),a={_csrf:window.csrfToken,tokenInfo:window.location.hash.slice(o)};return e.state="processing",t.post("/dropbox/completeRegistration",a).then((function(){e.state="success";return r((function(){return n.location.href="/user/settings"}),5e3)})).catch((function(n){var t=n.data;return e.state="error",t.error&&(e.error={code:t.error}),console.log("the request failed")}))}]),r.a.controller("DropboxSyncStatusController",["$scope","$http","$interval",function(e,n,t){var r=function(){n.get("/user/tpds/queues").then((function(n){var t=n.data;0===t.tpdsToWeb&&0===t.webToTpds?e.syncStatus="synced":t.tpdsToWeb>0&&t.webToTpds>0?e.syncStatus="both":t.tpdsToWeb>0?e.syncStatus="in":t.webToTpds>0?e.syncStatus="out":e.syncStatus="error"})).catch((function(){e.syncStatus="error"}))};r(),t(r,5e3)}]);r.a.controller("GithubSyncMenuEntryController",["$scope","$modal",function(e,n){return e.openImportModal=function(){return n.open({templateUrl:"githubSyncImportModalTemplate",controller:"GithubSyncImportModalController",size:"lg"})}}]),r.a.controller("GithubSyncImportModalController",["$scope","$modalInstance","$http",function(e,n,t){return e.cancel=function(){return n.dismiss()},e.handleError=function(n){var t=n.data,r=null;401===n.status?r="GithubCredentialsExpired":t&&t.error&&(r=t.error),e.status.error=!r||{code:r}},e.status={loading:!0,error:!1},t.get("/user/github-sync/status",{disableAutoLoginRedirect:!0}).then((function(n){var r=n.data;return e.status.user=r,r.enabled?t.get("/user/github-sync/repos",{disableAutoLoginRedirect:!0}).then((function(n){var t=n.data;return e.status.loading=!1,e.status.repos=t.repos})).catch(e.handleError):e.status.loading=!1})).catch((function(){return e.status.error=!0})),e.importRepo=function(n){return e.status.inflight=!0,t.post("/project/new/github-sync",{_csrf:window.csrfToken,projectName:n.name,repo:n.full_name,disableAutoLoginRedirect:!0}).then((function(e){var n=e.data.project_id;return window.location="/project/".concat(n)})).catch(e.handleError)}}]),r.a.controller("GithubSyncUnlinkController",["$scope","$modal",function(e,n){return e.unlinkAccount=function(){return n.open({templateUrl:"githubSyncUnlinkModalTemplate"})}}]),r.a.controller("LaunchpadController",["$scope","$http","$timeout",function(e,n,t){if(e.adminUserExists=window.data.adminUserExists,e.ideJsPath=window.data.ideJsPath,e.authMethod=window.data.authMethod,e.createAdminSuccess=null,e.createAdminError=null,e.statusChecks={ideJs:{status:"inflight",error:null},websocket:{status:"inflight",error:null},healthCheck:{status:"inflight",error:null}},e.testEmail={emailAddress:"",inflight:!1,status:null},e.shouldShowAdminForm=function(){return!e.adminUserExists},e.onCreateAdminSuccess=function(n){var t=n.status;if(t>=200&&t<300)return e.createAdminSuccess=!0},e.onCreateAdminError=function(){return e.createAdminError=!0},e.sendTestEmail=function(){return e.testEmail.inflight=!0,e.testEmail.status=null,n.post("/launchpad/send_test_email",{email:e.testEmail.emailAddress,_csrf:window.csrfToken}).then((function(n){var t=n.status;if(e.testEmail.inflight=!1,t>=200&&t<300)return e.testEmail.status="ok"})).catch((function(){return e.testEmail.inflight=!1,e.testEmail.status="error"}))},e.tryFetchIdeJs=function(){return e.statusChecks.ideJs.status="inflight",t((function(){return n.get(e.ideJsPath).then((function(n){var t=n.status;if(t>=200&&t<300)return e.statusChecks.ideJs.status="ok"})).catch((function(n){var t=n.status;return e.statusChecks.ideJs.status="error",e.statusChecks.ideJs.error=new Error("Http status: ".concat(t))}))}),1e3)},e.tryOpenWebSocket=function(){return e.statusChecks.websocket.status="inflight",t((function(){if("undefined"==typeof io||null===io)return e.statusChecks.websocket.status="error",void(e.statusChecks.websocket.error="socket.io not loaded");var n=io.connect(null,{reconnect:!1,"connect timeout":3e4,"force new connection":!0});return n.on("connectionAccepted",(function(){return e.statusChecks.websocket.status="ok",e.$apply((function(){}))})),n.on("connectionRejected",(function(n){return e.statusChecks.websocket.status="error",e.statusChecks.websocket.error=n,e.$apply((function(){}))})),n.on("connect_failed",(function(n){return e.statusChecks.websocket.status="error",e.statusChecks.websocket.error=n,e.$apply((function(){}))}))}),1e3)},e.tryHealthCheck=function(){return e.statusChecks.healthCheck.status="inflight",n.get("/health_check").then((function(n){var t=n.status;if(t>=200&&t<300)return e.statusChecks.healthCheck.status="ok"})).catch((function(n){var t=n.status;return e.statusChecks.healthCheck.status="error",e.statusChecks.healthCheck.error=new Error("Http status: ".concat(t))}))},e.runStatusChecks=function(){return t((function(){return e.tryFetchIdeJs()}),1e3),t((function(){return e.tryOpenWebSocket()}),2e3)},e.adminUserExists)return e.runStatusChecks()}]);r.a.controller("OpenInOverleafGatewayController",["$scope","$http","localStorage",function(e,n,t){function r(e){document.referrer&&!e.referrer&&(e.referrer=document.referrer)}function o(e){return 0===Object.keys(e).filter((function(e){return"referrer"!==e})).length?JSON.parse(window.sessionStorage.getItem("openInOverleaf"))||{}:e}e.error=!1,e.handleGateway=function(){var a,i,c=JSON.parse($("#overleaf-gateway-data").text());r(c.params),function(e){if(e.error)return!0;if("store"===e.action&&""!==e.target&&e.params)return!0;return"submit"===e.action&&e.params}(c)?c.error?e.serverError=c.error:"store"===c.action?(a=o(c.params),i=c.target,r(a),window.sessionStorage.setItem("openInOverleaf",JSON.stringify(a)),window.location.replace(i)):"submit"===c.action&&function(r,o){r._csrf=o,n({method:"POST",url:window.location.pathname,data:r}).then((function(n){n.error?e.serverError=n.error:n.data&&n.data.redirect?("true"===r.rich_text&&t("editor.mode."+n.data.projectId,"rich-text"),window.sessionStorage.setItem("openInOverleaf","{}"),window.location.replace(n.data.redirect)):e.error=!0}),(function(n){n.data&&n.data.error?e.serverError=n.data.error:e.error=!0}))}(o(c.params),c.csrfToken):e.error=!0}}]),r.a.controller("InstitutionFormController",["$scope",function(e){e.inflight=!1,e.inflightItem=null,e.samlInitPath=ExposedSettings.samlInitPath,e.submit=function(n){e.inflight=!0,e.inflightItem=n}}]);r.a.controller("PortalFormController",["$scope","$http",function(e,n){var t="Yes! I would like to explore an Overleaf Institutional Account.",r=Object(p.a)("ol-portalFormContext");e.portalSlug=r.portalSlug,e.portalTitle=r.portalTitle,e.portalType=r.portalType,e.siteUrl=r.siteUrl,e.form={department:"",email:Object(p.a)("ol-usersEmail"),firstName:r.usersFirstName,lastName:r.usersLastName,message:t,role:""},e.sent=!1,e.sending=!1,e.submitSupport=function(){if(null!=e.form.email&&""!==e.form.email){e.sending=!0;var r=e.form,o=r.department,a=r.firstName,i=r.lastName,c=r.message,s=r.role,l="".concat(e.siteUrl,"/").concat(e.portalType,"/").concat(e.portalSlug),u="\n      \n**Overleaf Portal Contact**\n      \n**Name:** ".concat(a," ").concat(i,"\n      \n**Message:** ").concat(c,"\n      \n**Role:** ").concat(s,"\n      \n**Department:** ").concat(o,"\n      \n**Portal:** ").concat(e.portalTitle,"\n      \n**Portal Link:** ").concat(l,"\n      "),d=c.trim()===t?"":"Custom Portal Message",f={_csrf:window.csrfToken,email:e.form.email,message:u||"",subject:"Overleaf Portal Contact",inbox:"portals",tags:d},m=n.post("/support",f);return m.then((function(n){return e.sent=!0})),m.catch((function(){return e.error=!0,console.log("the request failed")}))}e.error="Please include your email"}}]),t(535);r.a.controller("openInSlController",["$scope","$http","$window","$timeout",function(e,n,t,r){return e.openFromTemplateUrl=Object(p.a)("ol-openFromTemplateUrl"),e.downloadZipUrl=Object(p.a)("ol-downloadZipUrl"),e.openInSlText="Open in ShareLaTeX",e.isDisabled=!1,e.state={unpublishInFlight:!1,republishInFlight:!1,apiProblem:!1},e.buttonsDisabled=function(){return e.state.unpublishInFlight||e.state.republishInFlight},e.open=function(){return e.openInSlText="Creating...",e.isDisabled=!0,ga("send","event","template-site","open-in-sl",$(".page-header h1").text())},e.downloadZip=function(){return ga("send","event","template-site","download-zip",$(".page-header h1").text())},e.republish=function(r){return e.state.republishInFlight=!0,n.post("/project/".concat(r,"/template/publish"),{_csrf:window.csrfToken}).then((function(){return e.state.republishInFlight=!1,e.state.apiProblem=!1,t.location.reload()})).catch((function(){return e.state.republishInFlight=!1,e.state.apiProblem=!1}))},e.unpublish=function(o){return e.state.unpublishInFlight=!0,n.post("/project/".concat(o,"/template/unpublish"),{_csrf:window.csrfToken}).then((function(){return e.state.unpublishInFlight=!1,e.state.apiProblem=!1,r((function(){return t.location.href="/templates"}),500)})).catch((function(){return e.state.unpublishInFlight=!1,console.log(">> unpub failed"),e.state.apiProblem=!0}))}}]),r.a.controller("ReferenceUnlinkController",["$scope","$modal",function(e,n){return e.unlinkAccount=function(e){return n.open({templateUrl:"referenceUnlinkModalTemplate",controller:"ReferenceUnlinkModalController",resolve:{provider:function(){return e}}})}}]);r.a.controller("ReferenceUnlinkModalController",["$scope","$modalInstance","provider",function(e,n,t){return e.provider=t,e.providerUnlink="/".concat(t,"/unlink")}]);var O=t(471),L=t.n(O);r.a.controller("TwoFactorAuthenticationSetupController",["$scope",function(e){var n=Object(p.a)("ol-2fa-uri");e.othAuthUri=n;var t=document.getElementById("canvas");L.a.toCanvas(t,e.othAuthUri,(function(e){e&&console.error(e)}))}]),r.a.controller("TwoFactorAuthenticationCheckController",["$scope",function(e){}]);r.a.controller("TemplatePageController",["$scope","$modal",function(e,n){e.openViewSourceModal=function(){n.open({templateUrl:"viewSourceModalTemplate"})}}]);r.a.directive("addsearch",(function(){return{link:function(e,n,t){var r=n.find("input");return n.find("button").on("click",(function(e){return window.location.search="addsearch=".concat(r.val())}))}}})),angular.module("SharelatexApp").config(["$locationProvider",function(e){try{return e.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}catch(e){return console.error("Error while trying to fix '#' links: ",e)}}]);n.default=angular.bootstrap(document.body,["SharelatexApp"])}})}));